<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3 Импорт данных | Наука о данных в R для программы Цифровых гуманитарных исследований</title>
  <meta name="description" content="3 Импорт данных | Наука о данных в R для программы Цифровых гуманитарных исследований" />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="3 Импорт данных | Наука о данных в R для программы Цифровых гуманитарных исследований" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3 Импорт данных | Наука о данных в R для программы Цифровых гуманитарных исследований" />
  
  
  

<meta name="author" content="Г. А. Мороз, И. С. Поздняков" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="intro.html"/>
<link rel="next" href="tasks.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="libs/pagedtable-1.1/js/pagedtable.js"></script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Наука о данных в R для ЦГИ</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> О курсе</a></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Введение в R</a><ul>
<li class="chapter" data-level="2.1" data-path="intro.html"><a href="intro.html#наука-о-данных"><i class="fa fa-check"></i><b>2.1</b> Наука о данных</a></li>
<li class="chapter" data-level="2.2" data-path="intro.html"><a href="intro.html#установка-r-и-rstudio"><i class="fa fa-check"></i><b>2.2</b> Установка R и RStudio</a></li>
<li class="chapter" data-level="2.3" data-path="intro.html"><a href="intro.html#полезные-ссылки"><i class="fa fa-check"></i><b>2.3</b> Полезные ссылки</a></li>
<li class="chapter" data-level="2.4" data-path="intro.html"><a href="intro.html#rstudio"><i class="fa fa-check"></i><b>2.4</b> Rstudio</a></li>
<li class="chapter" data-level="2.5" data-path="intro.html"><a href="intro.html#введение-в-r"><i class="fa fa-check"></i><b>2.5</b> Введение в R</a><ul>
<li class="chapter" data-level="2.5.1" data-path="intro.html"><a href="intro.html#calc"><i class="fa fa-check"></i><b>2.5.1</b> R как калькулятор</a></li>
<li class="chapter" data-level="2.5.2" data-path="intro.html"><a href="intro.html#func"><i class="fa fa-check"></i><b>2.5.2</b> Функции</a></li>
<li class="chapter" data-level="2.5.3" data-path="intro.html"><a href="intro.html#variables"><i class="fa fa-check"></i><b>2.5.3</b> Переменные</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="intro.html"><a href="intro.html#data_types"><i class="fa fa-check"></i><b>2.6</b> Типы данных</a></li>
<li class="chapter" data-level="2.7" data-path="intro.html"><a href="intro.html#atomic"><i class="fa fa-check"></i><b>2.7</b> Вектор</a><ul>
<li class="chapter" data-level="2.7.1" data-path="intro.html"><a href="intro.html#coercion"><i class="fa fa-check"></i><b>2.7.1</b> Приведение типов</a></li>
<li class="chapter" data-level="2.7.2" data-path="intro.html"><a href="intro.html#vector_op"><i class="fa fa-check"></i><b>2.7.2</b> Векторизация</a></li>
<li class="chapter" data-level="2.7.3" data-path="intro.html"><a href="intro.html#recycling"><i class="fa fa-check"></i><b>2.7.3</b> Ресайклинг</a></li>
<li class="chapter" data-level="2.7.4" data-path="intro.html"><a href="intro.html#index_atomic"><i class="fa fa-check"></i><b>2.7.4</b> Индексирование векторов</a></li>
<li class="chapter" data-level="2.7.5" data-path="intro.html"><a href="intro.html#na"><i class="fa fa-check"></i><b>2.7.5</b> NA --- пропущенные значения</a></li>
<li class="chapter" data-level="2.7.6" data-path="intro.html"><a href="intro.html#google"><i class="fa fa-check"></i><b>2.7.6</b> В любой непонятной ситуации --- ищите в поисковике</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="intro.html"><a href="intro.html#matrix"><i class="fa fa-check"></i><b>2.8</b> Матрицы (matrix)</a></li>
<li class="chapter" data-level="2.9" data-path="intro.html"><a href="intro.html#list"><i class="fa fa-check"></i><b>2.9</b> Списки (list)</a></li>
<li class="chapter" data-level="2.10" data-path="intro.html"><a href="intro.html#df"><i class="fa fa-check"></i><b>2.10</b> Датафрейм</a></li>
<li class="chapter" data-level="2.11" data-path="intro.html"><a href="intro.html#real_data"><i class="fa fa-check"></i><b>2.11</b> Начинаем работу с реальными данными</a><ul>
<li class="chapter" data-level="2.11.1" data-path="intro.html"><a href="intro.html#wd"><i class="fa fa-check"></i><b>2.11.1</b> Рабочая папка и проекты</a></li>
<li class="chapter" data-level="2.11.2" data-path="intro.html"><a href="intro.html#import"><i class="fa fa-check"></i><b>2.11.2</b> Импорт данных</a></li>
</ul></li>
<li class="chapter" data-level="2.12" data-path="intro.html"><a href="intro.html#prep"><i class="fa fa-check"></i><b>2.12</b> Препроцессинг данных в R</a><ul>
<li class="chapter" data-level="2.12.1" data-path="intro.html"><a href="intro.html#explore"><i class="fa fa-check"></i><b>2.12.1</b> Исследование данных</a></li>
<li class="chapter" data-level="2.12.2" data-path="intro.html"><a href="intro.html#subset"><i class="fa fa-check"></i><b>2.12.2</b> Subsetting</a></li>
<li class="chapter" data-level="2.12.3" data-path="intro.html"><a href="intro.html#newcol"><i class="fa fa-check"></i><b>2.12.3</b> Создание новых колонок</a></li>
<li class="chapter" data-level="2.12.4" data-path="intro.html"><a href="intro.html#dtvstidy"><i class="fa fa-check"></i><b>2.12.4</b> data.table vs. tidyverse</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="intro.html"><a href="intro.html#real_data"><i class="fa fa-check"></i><b>3</b> Импорт данных</a><ul>
<li class="chapter" data-level="3.1" data-path="intro.html"><a href="intro.html#wd"><i class="fa fa-check"></i><b>3.1</b> Рабочая папка и проекты RStudio</a><ul>
<li class="chapter" data-level="3.1.1" data-path="real-data.html"><a href="real-data.html"><i class="fa fa-check"></i><b>3.1.1</b> Табличные данные: текстовые и бинарные данные</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="real-data.html"><a href="real-data.html#проверка-импортированных-данных"><i class="fa fa-check"></i><b>3.2</b> Проверка импортированных данных</a></li>
<li class="chapter" data-level="3.3" data-path="real-data.html"><a href="real-data.html#импорт-таблиц-в-бинарном-формате-таблицы-excel-spss"><i class="fa fa-check"></i><b>3.3</b> Импорт таблиц в бинарном формате: таблицы Excel, SPSS</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="tasks.html"><a href="tasks.html"><i class="fa fa-check"></i><b>4</b> Задания</a><ul>
<li class="chapter" data-level="4.1" data-path="tasks.html"><a href="tasks.html#vec_task_1"><i class="fa fa-check"></i><b>4.1</b> Вектор</a></li>
<li class="chapter" data-level="4.2" data-path="tasks.html"><a href="tasks.html#vec_op"><i class="fa fa-check"></i><b>4.2</b> Вектор. Операции с векторами</a></li>
<li class="chapter" data-level="4.3" data-path="tasks.html"><a href="tasks.html#vec_task_2"><i class="fa fa-check"></i><b>4.3</b> Вектор. Индексирование</a></li>
<li class="chapter" data-level="4.4" data-path="tasks.html"><a href="tasks.html#list_ta"><i class="fa fa-check"></i><b>4.4</b> Списки</a></li>
<li class="chapter" data-level="4.5" data-path="tasks.html"><a href="tasks.html#t"><i class="fa fa-check"></i><b>4.5</b> Матрицы</a></li>
<li class="chapter" data-level="4.6" data-path="tasks.html"><a href="tasks.html#task_function"><i class="fa fa-check"></i><b>4.6</b> Создание функций</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="solutions.html"><a href="solutions.html"><i class="fa fa-check"></i><b>5</b> Решения_заданий</a><ul>
<li class="chapter" data-level="5.1" data-path="solutions.html"><a href="solutions.html#solvvec_task_1"><i class="fa fa-check"></i><b>5.1</b> Вектор</a></li>
<li class="chapter" data-level="5.2" data-path="solutions.html"><a href="solutions.html#solvvec_op"><i class="fa fa-check"></i><b>5.2</b> Вектор. Операции с векторами</a></li>
<li class="chapter" data-level="5.3" data-path="solutions.html"><a href="solutions.html#solvvec_task_2"><i class="fa fa-check"></i><b>5.3</b> Вектор. Индексирование</a></li>
<li class="chapter" data-level="5.4" data-path="solutions.html"><a href="solutions.html#solvlist_ta"><i class="fa fa-check"></i><b>5.4</b> Списки</a></li>
<li class="chapter" data-level="5.5" data-path="solutions.html"><a href="solutions.html#solvt"><i class="fa fa-check"></i><b>5.5</b> Матрицы</a></li>
<li class="chapter" data-level="5.6" data-path="solutions.html"><a href="solutions.html#solvtask_function"><i class="fa fa-check"></i><b>5.6</b> Создание функций</a></li>
<li class="chapter" data-level="5.7" data-path="solutions.html"><a href="solutions.html#solvtask_text"><i class="fa fa-check"></i><b>5.7</b> Семейство apply()</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ссылки-на-литературу.html"><a href="ссылки-на-литературу.html"><i class="fa fa-check"></i>Ссылки на литературу</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Наука о данных в R для программы Цифровых гуманитарных исследований</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="real_data" class="section level1">
<h1><span class="header-section-number">3</span> Импорт данных</h1>
<p>Итак, пришло время перейти к реальным данным. Мы начнем с использования датасета (так мы будем называть любой набор данных) по супергероям. Этот датасет представляет собой табличку, каждая строка которой - отдельный супергерой, а столбик --- какая-либо информация о нем. Например, цвет глаз, цвет волос, вселенная супергероя<a href="#fn1" class="footnoteRef" id="fnref1"><sup>1</sup></a>, рост, вес, пол и так далее. Несложно заметить, что этот датасет идеально подходит под структуру датафрейма: прямоугольная табличка, внутри которой есть разные колонки, каждая из которой имеет свой тип (числовой или строковый).</p>
<div id="wd" class="section level2">
<h2><span class="header-section-number">3.1</span> Рабочая папка и проекты RStudio</h2>
<p>Для начала скачайте файл по <a href="https://raw.githubusercontent.com/agricolamz/2020-2021-ds4dh/master/data/heroes_information.csv">ссылке</a></p>
<p>Он, скорее всего, появился у Вас в папке &quot;Загрузки&quot;. Если мы будем просто пытаться прочитать этот файл (например, с помощью <code>read.csv()</code> --- мы к этой функцией очень скоро перейдем), указав его имя и разрешение, то наткнемся на такую ошибку:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">read.csv</span>(<span class="st">&quot;heroes_information.csv&quot;</span>)</code></pre></div>
<pre><code>## Warning in file(file, &quot;rt&quot;): не могу открыть файл &#39;heroes_information.csv&#39;: No
## such file or directory</code></pre>
<pre><code>## Error in file(file, &quot;rt&quot;): не могу открыть соединение</code></pre>
<p>Это означает, что R не может найти нужный файл. Вообще-то мы даже не сказали, где искать. Нам нужно как-то совместить место, где R ищет загружаемые файлы и сами файлы. Для этого есть несколько способов.</p>
<ul>
<li>Магомет идет к горе: перемещение файлов в рабочую папку.</li>
</ul>
<p>Для этого нужно узнать, какая папка является рабочей с помощью функции <code>getwd()</code> (без аргументов), найти эту папку в проводнике и переместить туда файл. После этого можно использовать просто название файла с разрешением:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">heroes &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;heroes_information.csv&quot;</span>)</code></pre></div>
<p>Кроме того, путь к рабочей папке можно увидеть в RStudio во вкладке с консолью, в самой верхней части (прямо под надписью &quot;Console&quot;):</p>
<div class="figure">
<img src="images/Console_wd.png" width="400" />

</div>
<ul>
<li>Гора идет к Магомету: изменение рабочей папки.</li>
</ul>
<p>Можно просто сменить рабочую папку с помощью <code>setwd()</code> на ту, где сейчас лежит файл, прописав путь до этой папки. Теперь файл находится в рабочей папке:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">heroes &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;heroes_information.csv&quot;</span>)</code></pre></div>
<p>Этот вариант использовать не рекомендуется! Как минимум, это сразу делает невозможным запустить скрипт на другом компьютере.</p>
<ul>
<li>Гора находит Магомета по месту прописки: указание полного пути файла.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">heroes &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;/Users/Username/Some_Folder/heroes_information.csv&quot;</span>)</code></pre></div>
<p>Этот вариант страдает теми же проблемами, что и предыдущий, поэтому тоже не рекомендуется!</p>
<blockquote>
<p>Для пользователей Windows есть дополнительная сложность: знак <code>/</code> является особым знаком для R, поэтому вместо него нужно использовать двойной <code>//</code>.</p>
</blockquote>
<ul>
<li>Магомет использует кнопочный интерфейс: Import Dataset.</li>
</ul>
<p>Во вкладке Environment справа в окне RStudio есть кнопка &quot;Import Dataset&quot;. Возможно, у Вас возникло непреодолимое желание отдохнуть от написания кода и понажимать кнопочки --- сопротивляйтесь этому всеми силами, но не вините себя, если не сдержитесь.</p>
<ul>
<li>Гора находит Магомета в интернете.</li>
</ul>
<p>Многие функции в R, предназначенные для чтения файлов, могут прочитать файл не только на Вашем компьютере, но и сразу из интернета. Для этого просто используйте ссылку вместо пути:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">heroes &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;https://raw.githubusercontent.com/agricolamz/2020-2021-ds4dh/master/data/heroes_information.csv&quot;</span>)</code></pre></div>
<ul>
<li>Каждый Магомет получает по своей горе: использование проектов в RStudio.</li>
</ul>
<p>На первый взгляд это кажется чем-то очень сложным, но это не так. Это очень просто и ОЧЕНЬ удобно. При создании проекта создается отдельная папочка, где у Вас лежат данные, хранятся скрипты, вспомогательные файлы и отчеты. Если нужно вернуться к другому проекту --- просто открываете другой проект, с другими файлами и скриптами. Это еще помогает не пересекаться переменным из разных проектов --- а то, знаете, использование двух переменных <code>data</code> в разных скриптах чревато ошибками. Поэтому очень удобным решением будет выделение отдельного проекта под этот курс.</p>
<blockquote>
<p>При закрытии проекта все переменные по умолчанию тоже будут сохраняться, а при открытии --- восстанавливаться. Это очень удобно, хотя некоторые <a href="https://r4ds.had.co.nz/workflow-projects.html">рекомендуют от этого отказаться</a>. Это можно сделать во вкладке <code>Tool - Global Options...</code></p>
</blockquote>
<div id="text_binary" class="section level3">
<h3><span class="header-section-number">3.1.1</span> Табличные данные: текстовые и бинарные данные</h3>
<p>Как Вы уже поняли, импортирование данных - одна из самых муторных и неприятных вещей в R. Если у Вас получится с этим справится, то все остальное - ерунда. Мы уже разобрались с первой частью этого процесса - нахождением файла с данными, осталось научиться их читать.</p>
<p>Здесь стоит сделать небольшую ремарку. Довольно часто данные представляют собой табличку. Или же их можно свести к табличке. Такая табличка, как мы уже выяснили, удобно репрезентируется в виде датафрейма. Но как эти данные хранятся на компьютере? Есть два варианта: в <em>бинарном</em> и в <em>текстовом</em> файле.</p>
<p>Текстовый файл означает, что такой файл можно открыть в программе &quot;Блокнот&quot; или аналоге (например, TextEdit на macOS) и увидеть напечатанный текст: скрипт, роман или упорядоченный набор цифр и букв. Нас сейчас интересует именно последний случай. Таблица может быть представлена как текст: отдельные строчки в файле будут разделять разные строчки таблицы, а какой-нибудь знак-разделитель отделять колонки друг от друга.</p>
<p>Для чтения данных из текстового файла есть довольно удобная функция <code>read.table()</code>. Почитайте хэлп по ней и ужаснитесь: столько разных параметров на входе! Но там же вы увидете функции <code>read.csv()</code>, <code>read.csv2()</code> и некоторые другие --- по сути, это тот же <code>read.table()</code>, но с другими параметрами по умолчанию, соответствующие формату файла, который мы загружаем. В данном случае используется формат .csv, что означает &quot;Comma Separated Values&quot; (Значения, Разделенные Запятыми). Формат .csv --- это самый известный способ хранения табличных данных в файде на сегодняшний день. Файлы с расширением .csv можно легко открыть в любой программе, работающей с таблицами, в том числе Microsoft Excel и его аналогах.</p>
<p>Файл с расширением .csv --- это просто текстовый файл, в котором &quot;закодирована&quot; таблица: разные строчки разделяют разные строчки таблицы, а столбцы отделяются запятыми (отсюда и название). Вы можете вручную создать такие файлы в Блокноте и сохранять их с форматом .csv - и такая табличка будет нормально открываться в Microsoft Excel и других программах для работы с таблицами. Можете попробовать это сделать самостоятельно!</p>
<p>Как говорилось ранее, в качестве разделителя ячеек по горизонтали --- то есть разделителя между столбцами --- используется запятая. С этим связана одна проблема: в некоторых странах (в т.ч. и России) принято использовать запятую для разделения дробной части числа, а не точку, как это делается в большинстве стран мира. Поэтому есть альтернативный вариант формата .csv, где значения разделены точкой с запятой (<code>;</code>), а дробные значения - запятой (<code>,</code>). В этом и различие функций <code>read.csv()</code> и <code>read.csv2()</code> --- первая функция предназначена для &quot;международного&quot; формата, вторая - для (условно) &quot;Российского&quot;. Оба варианта формата имеют расширение .csv, поэтому заранее понять какой именно будет вариант довольно сложно, приходится либо пробовать оба, либо заранее открывать файл в текстовом редакторе.</p>
<p>В первой строчке обычно содержатся названия столбцов - и это чертовски удобно, функции <code>read.csv()</code> и <code>read.csv2()</code> по умолчанию считают первую строчку именно как название для колонок.</p>
<p>Кроме .csv формата есть и другие варианты хранения таблиц в виде текста. Например, .tsv --- тоже самое, что и .csv, но разделитель - знак табуляции. Для чтения таких файлов есть функция <code>read.delim()</code> и <code>read.delim2()</code>. Впрочем, даже если бы ее и не было, можно было бы просто подобрать нужные параметры для функции <code>read.table()</code>. Есть даже функции, которые пытаются сами &quot;угадать&quot; нужные параметры для чтения --- часто они справляются с этим довольно удачно. Но не всегда. Поэтому стоит научиться справляться с любого рода данными на входе.</p>
<p>Итак, прочитаем наш файл. Для этого используем только параметр <code>file =</code>, который идет первым, и для параметра <code>stringsAsFactors =</code> поставим значение <code>FALSE</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">heroes &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/heroes_information.csv&quot;</span>, <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)</code></pre></div>
<blockquote>
<p>Параметр <code>stringsAsFactors =</code> задает то, как будут прочитаны строковые значения - как уже знакомые нам строки или как факторы. По сути, факторы - это примерно то же самое, что и character, но закодированные числами. Когда-то это было придумано для экономии используемых времени и памяти, сейчас же обычно становится просто лишней морокой. Но некоторые функции требуют именно character, некоторые factor, в большинстве случаев это без разницы. Но иногда непонимание может привести к дурацким ошибкам. В данном случае мы просто пока обойдемся без факторов. Если у вас версия R выше 4.0, то <code>stringsAsFactors =</code> будет <code>FALSE</code> по умолчанию.</p>
</blockquote>
<p>Можете проверить с помощью <code>View(heroes)</code>: все работает! Если же вылезает какая-то странная ерунда или же просто ошибка - попробуйте другие функции (<code>read.table()</code>, <code>read.delim()</code>) и покопаться с параметрами. Для этого читайте <code>Help</code>.</p>
</div>
</div>
<div id="проверка-импортированных-данных" class="section level2">
<h2><span class="header-section-number">3.2</span> Проверка импортированных данных</h2>
<p>При импорте данных обратите внимания на предупреждения (если таковые появляются), в большинстве случаев они указывают на то, что данные импортированы некорректно.</p>
<p>Проверим, что все прочиталось нормально с помощью уже известной нам функции <code>str()</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str</span>(heroes)</code></pre></div>
<pre><code>## &#39;data.frame&#39;:    734 obs. of  11 variables:
##  $ X         : int  0 1 2 3 4 5 6 7 8 9 ...
##  $ name      : chr  &quot;A-Bomb&quot; &quot;Abe Sapien&quot; &quot;Abin Sur&quot; &quot;Abomination&quot; ...
##  $ Gender    : chr  &quot;Male&quot; &quot;Male&quot; &quot;Male&quot; &quot;Male&quot; ...
##  $ Eye.color : chr  &quot;yellow&quot; &quot;blue&quot; &quot;blue&quot; &quot;green&quot; ...
##  $ Race      : chr  &quot;Human&quot; &quot;Icthyo Sapien&quot; &quot;Ungaran&quot; &quot;Human / Radiation&quot; ...
##  $ Hair.color: chr  &quot;No Hair&quot; &quot;No Hair&quot; &quot;No Hair&quot; &quot;No Hair&quot; ...
##  $ Height    : num  203 191 185 203 -99 193 -99 185 173 178 ...
##  $ Publisher : chr  &quot;Marvel Comics&quot; &quot;Dark Horse Comics&quot; &quot;DC Comics&quot; &quot;Marvel Comics&quot; ...
##  $ Skin.color: chr  &quot;-&quot; &quot;blue&quot; &quot;red&quot; &quot;-&quot; ...
##  $ Alignment : chr  &quot;good&quot; &quot;good&quot; &quot;good&quot; &quot;bad&quot; ...
##  $ Weight    : int  441 65 90 441 -99 122 -99 88 61 81 ...</code></pre>
<blockquote>
<p>Всегда проверяйте данные на входе и никогда не верьте на слово, если вам говорят, что данные вычищенные и не содержат никаких ошибок.</p>
</blockquote>
<p>На что нужно обращать внимание?</p>
<ol style="list-style-type: decimal">
<li><p>Прочитаны ли пропущенные значения как <code>NA</code>. По умолчанию пропущенные значения обозначаются пропущенной строчкой или &quot;NA&quot;, но встречаются самые разнообразные варианты. Возможные варианты кодирования пропущенных значений можно задать в параметре <code>na.strings =</code> функции <code>read.table()</code> и ее вариантов. В нашем датасете как раз такая ситуация, где нужно самостоятельно задавать, какие значения будут прочитаны как <code>NA</code>. Попытайтесь самостоятельно догадаться, как именно.</p></li>
<li><p>Прочитаны ли те столбики, которые должны быть числовыми, как <code>int</code> или <code>num</code>. Если в колонке содержатся числа, а написано <code>chr</code> (= <code>&quot;character&quot;</code>) или <code>Factor</code> (в случае если <code>stringsAsFactors = TRUE</code>), то, скорее всего, одна из строчек содержит в себе нечисловые знаки, которые не были прочитаны как <code>NA</code>.</p></li>
<li><p>Странные названия колонок. Это может случиться по самым разным причинам, но в таких случаях стоит открывать файл в другой программе и смотреть первые строчки. Например, может оказаться, что первые несколько строчек --- пустые или что первая строчка не содержит название столбцов (тогда для параметра <code>header =</code> нужно поставить <code>FALSE</code>)</p></li>
<li><p>Вместо строковых данных у вас кракозябры. Это означает проблемы с кодировкой. В первую очередь попробуйте выставить значение <code>&quot;UTF-8&quot;</code> для параметра <code>encoding =</code> в функции для чтения файла:</p></li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">heroes &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/heroes_information.csv&quot;</span>, 
                   <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>,
                   <span class="dt">encoding =</span> <span class="st">&quot;UTF-8&quot;</span>)</code></pre></div>
<p>В случае если это не помогает, попробуйте <a href="https://www.artlebedev.ru/decoder/">разобрать</a>, что это за кодировка.</p>
<ol start="5" style="list-style-type: decimal">
<li><p>Все прочиталось как одна колонка. В этом случае, скорее всего, неправильно подобран разделить колонок --- параметр <code>sep =</code>. Откройте файл в текстовом редакторе, чтобы понять какой нужно использовать.</p></li>
<li><p>В отдельных строчках все прочиталось как одна колонка, а в остальных нормально. Скорее всего, в файле есть значения типа <code>\</code> или <code>&quot;</code>, которые в функциях <code>read.csv()</code>, <code>read.delim()</code>, <code>read.csv2()</code>, <code>read.delim2()</code> читаются как символы для закавычивания значений. Это может понадобиться, если у вас в таблице есть строковые значения со знаками <code>,</code> или <code>;</code>, которые могут восприниматься как разделитель столбцов.</p></li>
<li><p>Появились какие-то новые числовые колонки. Возможно неправильно поставлен разделитель дробной части. Обычно это либо <code>.</code> (<code>read.table()</code>, <code>read.csv()</code>, <code>read.delim()</code>), либо <code>,</code> (<code>read.csv2()</code>, <code>read.delim2()</code>).</p></li>
</ol>
<p>Конкретно в нашем случае все прочиталось хорошо с помощью функции <code>read.csv()</code>, но в строковых переменных есть много прочерков, которые обозначают отсутствие информации по данному параметру супергероя, т.е. пропущенное значение. А вот с числовыми значениями все не так просто: для всех супергероев прописано какое-то число, но во многих случаях это -99. Очевидно, отрицательного роста и массы не бывает, это просто обозначение пропущенных значений (такое часто используется). Таким образом, чтобы адекватно прочитать файл, нам нужно поменять параметр <code>na.strings =</code> функции <code>read.csv()</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">heroes &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/heroes_information.csv&quot;</span>, 
                   <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>,
                   <span class="dt">na.strings =</span> <span class="kw">c</span>(<span class="st">&quot;-&quot;</span>, <span class="st">&quot;-99&quot;</span>))</code></pre></div>
</div>
<div id="импорт-таблиц-в-бинарном-формате-таблицы-excel-spss" class="section level2">
<h2><span class="header-section-number">3.3</span> Импорт таблиц в бинарном формате: таблицы Excel, SPSS</h2>
<p>Тем не менее, далеко не всегда таблицы представлены в виде текстового файла. Самый распространенный пример таблицы в бинарном виде --- родные форматы Microsoft Excel. Если Вы попробуете открыть .xlsx файл в Блокноте, то увидите кракозябры. Это делает работу с этим файлами гораздо менее удобной, поэтому стоит избегать экселевских форматов и стараться все сохранять в .csv.</p>
<p>Такие файлы не получится прочитать при помощи базового инструментария R. Тем не менее, для чтения таких файлов есть много дополнительных пакетов:</p>
<ul>
<li><p>файлы Microsoft Excel: лучше всего справляется пакет <code>readxl</code> (является частью расширенного tidyverse), у него есть много альтернатив (<code>xlsx</code>, <code>openxlsx</code>).</p></li>
<li><p>файлы SPSS, SAS, Stata: существуют два основных пакета --- <code>haven</code> (часть расширенного tidyverse) и <code>foreign</code>.</p></li>
</ul>
<p>Что такое пакеты и как их устанавливать мы изучим очень скоро.</p>

</div>
</div>
<div class="footnotes">
<hr />
<ol start="1">
<li id="fn1"><p>супергерои в комиксах, фильмах и телесериалах часто взаимодействуют друг с другом, однако обычно это взаимодействие происходит между супергероями одного издателя. Два крупнейших издателя комиксов --- DC и Marvel, поэтому принято говорить о вселенной DC и Marvel.<a href="real-data.html#fnref1">↩</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="intro.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="tasks.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/agricolamz/DS_for_DH/edit/master/02-Import_data.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["DS_for_DH.pdf", "DS_for_DH.epub"],
"toc": {
"collapse": "section"
},
"self_contained": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
