<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>15 Корреляция и регрессия | Наука о данных в R для программы Цифровых гуманитарных исследований</title>
  <meta name="description" content="15 Корреляция и регрессия | Наука о данных в R для программы Цифровых гуманитарных исследований" />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="15 Корреляция и регрессия | Наука о данных в R для программы Цифровых гуманитарных исследований" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="15 Корреляция и регрессия | Наука о данных в R для программы Цифровых гуманитарных исследований" />
  
  
  

<meta name="author" content="Г. А. Мороз, И. С. Поздняков" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="проверка-статистических-гипотез.html"/>
<link rel="next" href="работа-статистического-детектива.html"/>
<script src="libs/header-attrs-2.8/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="libs/pagedtable-1.1/js/pagedtable.js"></script>
<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<link href="libs/str_view-0.1.0/str_view.css" rel="stylesheet" />
<script src="libs/str_view-binding-1.4.0/str_view.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.0.4.1/leaflet.js"></script>
<script src="libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.0.4.1/leaflet-providers-plugin.js"></script>
<script src="libs/Leaflet.Sync-0.0.5/L.Map.Sync.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Наука о данных в R для ЦГИ</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> О курсе</a></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Введение в R</a>
<ul>
<li class="chapter" data-level="2.1" data-path="intro.html"><a href="intro.html#наука-о-данных"><i class="fa fa-check"></i><b>2.1</b> Наука о данных</a></li>
<li class="chapter" data-level="2.2" data-path="intro.html"><a href="intro.html#установка-r-и-rstudio"><i class="fa fa-check"></i><b>2.2</b> Установка R и RStudio</a></li>
<li class="chapter" data-level="2.3" data-path="intro.html"><a href="intro.html#полезные-ссылки"><i class="fa fa-check"></i><b>2.3</b> Полезные ссылки</a></li>
<li class="chapter" data-level="2.4" data-path="intro.html"><a href="intro.html#rstudio"><i class="fa fa-check"></i><b>2.4</b> Rstudio</a></li>
<li class="chapter" data-level="2.5" data-path="intro.html"><a href="intro.html#введение-в-r"><i class="fa fa-check"></i><b>2.5</b> Введение в R</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="intro.html"><a href="intro.html#calc"><i class="fa fa-check"></i><b>2.5.1</b> R как калькулятор</a></li>
<li class="chapter" data-level="2.5.2" data-path="intro.html"><a href="intro.html#func"><i class="fa fa-check"></i><b>2.5.2</b> Функции</a></li>
<li class="chapter" data-level="2.5.3" data-path="intro.html"><a href="intro.html#variables"><i class="fa fa-check"></i><b>2.5.3</b> Переменные</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="intro.html"><a href="intro.html#logic"><i class="fa fa-check"></i><b>2.6</b> Логические операторы</a></li>
<li class="chapter" data-level="2.7" data-path="intro.html"><a href="intro.html#data_types"><i class="fa fa-check"></i><b>2.7</b> Типы данных</a></li>
<li class="chapter" data-level="2.8" data-path="intro.html"><a href="intro.html#atomic"><i class="fa fa-check"></i><b>2.8</b> Вектор</a>
<ul>
<li class="chapter" data-level="2.8.1" data-path="intro.html"><a href="intro.html#coercion"><i class="fa fa-check"></i><b>2.8.1</b> Приведение типов</a></li>
<li class="chapter" data-level="2.8.2" data-path="intro.html"><a href="intro.html#vector_op"><i class="fa fa-check"></i><b>2.8.2</b> Векторизация</a></li>
<li class="chapter" data-level="2.8.3" data-path="intro.html"><a href="intro.html#recycling"><i class="fa fa-check"></i><b>2.8.3</b> Ресайклинг</a></li>
<li class="chapter" data-level="2.8.4" data-path="intro.html"><a href="intro.html#index_atomic"><i class="fa fa-check"></i><b>2.8.4</b> Индексирование векторов</a></li>
<li class="chapter" data-level="2.8.5" data-path="intro.html"><a href="intro.html#na"><i class="fa fa-check"></i><b>2.8.5</b> NA — пропущенные значения</a></li>
<li class="chapter" data-level="2.8.6" data-path="intro.html"><a href="intro.html#google"><i class="fa fa-check"></i><b>2.8.6</b> В любой непонятной ситуации — ищите в поисковике</a></li>
</ul></li>
<li class="chapter" data-level="2.9" data-path="intro.html"><a href="intro.html#matrix"><i class="fa fa-check"></i><b>2.9</b> Матрицы (matrix)</a></li>
<li class="chapter" data-level="2.10" data-path="intro.html"><a href="intro.html#list"><i class="fa fa-check"></i><b>2.10</b> Списки (list)</a></li>
<li class="chapter" data-level="2.11" data-path="intro.html"><a href="intro.html#df"><i class="fa fa-check"></i><b>2.11</b> Датафрейм</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="real-data.html"><a href="real-data.html"><i class="fa fa-check"></i><b>3</b> Импорт данных</a>
<ul>
<li class="chapter" data-level="3.1" data-path="real-data.html"><a href="real-data.html#wd"><i class="fa fa-check"></i><b>3.1</b> Рабочая папка и проекты RStudio</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="real-data.html"><a href="real-data.html#text_binary"><i class="fa fa-check"></i><b>3.1.1</b> Табличные данные: текстовые и бинарные данные</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="real-data.html"><a href="real-data.html#проверка-импортированных-данных"><i class="fa fa-check"></i><b>3.2</b> Проверка импортированных данных</a></li>
<li class="chapter" data-level="3.3" data-path="real-data.html"><a href="real-data.html#export_data"><i class="fa fa-check"></i><b>3.3</b> Экспорт данных</a></li>
<li class="chapter" data-level="3.4" data-path="real-data.html"><a href="real-data.html#binary"><i class="fa fa-check"></i><b>3.4</b> Импорт таблиц в бинарном формате: таблицы Excel, SPSS</a></li>
<li class="chapter" data-level="3.5" data-path="real-data.html"><a href="real-data.html#fastread"><i class="fa fa-check"></i><b>3.5</b> Быстрый импорт данных</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="loops-conditions.html"><a href="loops-conditions.html"><i class="fa fa-check"></i><b>4</b> Условные конструкции и циклы</a>
<ul>
<li class="chapter" data-level="4.1" data-path="loops-conditions.html"><a href="loops-conditions.html#if"><i class="fa fa-check"></i><b>4.1</b> Выражения <code>if</code>, <code>else</code>, <code>else if</code></a></li>
<li class="chapter" data-level="4.2" data-path="loops-conditions.html"><a href="loops-conditions.html#for"><i class="fa fa-check"></i><b>4.2</b> Циклы <code>for</code></a></li>
<li class="chapter" data-level="4.3" data-path="loops-conditions.html"><a href="loops-conditions.html#ifelse"><i class="fa fa-check"></i><b>4.3</b> Векторизованные условные конструкции: функции <code>ifelse()</code> и <code>dplyr::case_when()</code></a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="functional.html"><a href="functional.html"><i class="fa fa-check"></i><b>5</b> Функциональное программирование в R</a>
<ul>
<li class="chapter" data-level="5.1" data-path="functional.html"><a href="functional.html#create_fun"><i class="fa fa-check"></i><b>5.1</b> Создание функций</a></li>
<li class="chapter" data-level="5.2" data-path="functional.html"><a href="functional.html#sanity_check"><i class="fa fa-check"></i><b>5.2</b> Проверка на адекватность</a></li>
<li class="chapter" data-level="5.3" data-path="functional.html"><a href="functional.html#why_functions"><i class="fa fa-check"></i><b>5.3</b> Когда и зачем создавать функции?</a></li>
<li class="chapter" data-level="5.4" data-path="functional.html"><a href="functional.html#functions_objects"><i class="fa fa-check"></i><b>5.4</b> Функции как объекты первого порядка</a></li>
<li class="chapter" data-level="5.5" data-path="functional.html"><a href="functional.html#apply_f"><i class="fa fa-check"></i><b>5.5</b> Семейство функций apply()</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="functional.html"><a href="functional.html#apply"><i class="fa fa-check"></i><b>5.5.1</b> Применение <code>apply()</code> для матриц</a></li>
<li class="chapter" data-level="5.5.2" data-path="functional.html"><a href="functional.html#anon_f"><i class="fa fa-check"></i><b>5.5.2</b> Анонимные функции</a></li>
<li class="chapter" data-level="5.5.3" data-path="functional.html"><a href="functional.html#apply_other"><i class="fa fa-check"></i><b>5.5.3</b> Другие функции семейства <code>apply()</code></a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="functional.html"><a href="functional.html#tidy_verse"><i class="fa fa-check"></i><b>5.6</b> Вселенная tidyverse</a></li>
<li class="chapter" data-level="5.7" data-path="functional.html"><a href="functional.html#загрузка-данных-с-помощью-readr"><i class="fa fa-check"></i><b>5.7</b> Загрузка данных с помощью <code>readr</code></a></li>
<li class="chapter" data-level="5.8" data-path="functional.html"><a href="functional.html#pipe"><i class="fa fa-check"></i><b>5.8</b> magrittr::<code>%&gt;%</code></a></li>
<li class="chapter" data-level="5.9" data-path="functional.html"><a href="functional.html#главные-пакеты-tidyverse-dplyr-и-tidyr"><i class="fa fa-check"></i><b>5.9</b> Главные пакеты tidyverse: <code>dplyr</code> и <code>tidyr</code></a></li>
<li class="chapter" data-level="5.10" data-path="functional.html"><a href="functional.html#tidy_select_cols"><i class="fa fa-check"></i><b>5.10</b> Работа с колонками тиббла</a>
<ul>
<li class="chapter" data-level="5.10.1" data-path="functional.html"><a href="functional.html#выбор-колонок-dplyrselect"><i class="fa fa-check"></i><b>5.10.1</b> Выбор колонок: <code>dplyr::select()</code></a></li>
<li class="chapter" data-level="5.10.2" data-path="functional.html"><a href="functional.html#tidyselect"><i class="fa fa-check"></i><b>5.10.2</b> Мини-язык tidyselect для выбора колонок</a></li>
</ul></li>
<li class="chapter" data-level="5.11" data-path="functional.html"><a href="functional.html#tidy_select_rows"><i class="fa fa-check"></i><b>5.11</b> Работа со строками тиббла</a>
<ul>
<li class="chapter" data-level="5.11.1" data-path="functional.html"><a href="functional.html#tidy_slice"><i class="fa fa-check"></i><b>5.11.1</b> Выбор строк по номеру: <code>dplyr::slice()</code></a></li>
<li class="chapter" data-level="5.11.2" data-path="functional.html"><a href="functional.html#tidy_filter"><i class="fa fa-check"></i><b>5.11.2</b> Выбор строк по условию: <code>dplyr::filter()</code></a></li>
<li class="chapter" data-level="5.11.3" data-path="functional.html"><a href="functional.html#slice_family"><i class="fa fa-check"></i><b>5.11.3</b> Семейство функций <code>slice()</code></a></li>
<li class="chapter" data-level="5.11.4" data-path="functional.html"><a href="functional.html#tidy_drop_na"><i class="fa fa-check"></i><b>5.11.4</b> Удаление строчек с NA: <code>tidyr::drop_na()</code></a></li>
<li class="chapter" data-level="5.11.5" data-path="functional.html"><a href="functional.html#tidy_arrange"><i class="fa fa-check"></i><b>5.11.5</b> Сортировка строк: <code>dplyr::arrange()</code></a></li>
</ul></li>
<li class="chapter" data-level="5.12" data-path="functional.html"><a href="functional.html#tidy_mutate"><i class="fa fa-check"></i><b>5.12</b> Создание колонок: <code>dplyr::mutate()</code> и <code>dplyr::transmute()</code></a></li>
<li class="chapter" data-level="5.13" data-path="functional.html"><a href="functional.html#tidy_aggregate"><i class="fa fa-check"></i><b>5.13</b> Агрегация данных в тиббле</a>
<ul>
<li class="chapter" data-level="5.13.1" data-path="functional.html"><a href="functional.html#summarise"><i class="fa fa-check"></i><b>5.13.1</b> Подытоживание: <code>summarise()</code></a></li>
<li class="chapter" data-level="5.13.2" data-path="functional.html"><a href="functional.html#tidy_group"><i class="fa fa-check"></i><b>5.13.2</b> Группировка: <code>group_by()</code></a></li>
<li class="chapter" data-level="5.13.3" data-path="functional.html"><a href="functional.html#tidy_count"><i class="fa fa-check"></i><b>5.13.3</b> Подсчет строк: <code>dplyr::n()</code>, <code>dplyr::count()</code></a></li>
<li class="chapter" data-level="5.13.4" data-path="functional.html"><a href="functional.html#tidy_distinct"><i class="fa fa-check"></i><b>5.13.4</b> Уникальные значения: <code>dplyr::distinct()</code></a></li>
<li class="chapter" data-level="5.13.5" data-path="functional.html"><a href="functional.html#tidy_group_mutate"><i class="fa fa-check"></i><b>5.13.5</b> Создание колонок с группировкой</a></li>
</ul></li>
<li class="chapter" data-level="5.14" data-path="functional.html"><a href="functional.html#трансформация-нескольких-колонок-dplyracross"><i class="fa fa-check"></i><b>5.14</b> Трансформация нескольких колонок: <code>dplyr::across()</code></a></li>
<li class="chapter" data-level="5.15" data-path="functional.html"><a href="functional.html#tidy_several"><i class="fa fa-check"></i><b>5.15</b> Объединение нескольких датафреймов</a>
<ul>
<li class="chapter" data-level="5.15.1" data-path="functional.html"><a href="functional.html#tidy_bind"><i class="fa fa-check"></i><b>5.15.1</b> Соединение структурно схожих датафреймов: bind_rows(), bind_cols()</a></li>
<li class="chapter" data-level="5.15.2" data-path="functional.html"><a href="functional.html#tidy_join"><i class="fa fa-check"></i><b>5.15.2</b> Реляционные данные: <code>*_join()</code></a></li>
</ul></li>
<li class="chapter" data-level="5.16" data-path="functional.html"><a href="functional.html#tidy_data"><i class="fa fa-check"></i><b>5.16</b> Tidy data: <code>tidyr::pivot_longer()</code>, <code>tidyr::pivot_wider()</code></a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="viz-1.html"><a href="viz-1.html"><i class="fa fa-check"></i><b>6</b> Визуализация данных</a>
<ul>
<li class="chapter" data-level="6.1" data-path="viz-1.html"><a href="viz-1.html#зачем-визуализировать-данные"><i class="fa fa-check"></i><b>6.1</b> Зачем визуализировать данные?</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="viz-1.html"><a href="viz-1.html#квартет-анскомба"><i class="fa fa-check"></i><b>6.1.1</b> Квартет Анскомба</a></li>
<li class="chapter" data-level="6.1.2" data-path="viz-1.html"><a href="viz-1.html#датазаурус"><i class="fa fa-check"></i><b>6.1.2</b> Датазаурус</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="viz-1.html"><a href="viz-1.html#основы-ggplot2"><i class="fa fa-check"></i><b>6.2</b> Основы <code>ggplot2</code></a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="viz-1.html"><a href="viz-1.html#диаграмма-рассеяния-scaterplot"><i class="fa fa-check"></i><b>6.2.1</b> Диаграмма рассеяния (Scaterplot)</a></li>
<li class="chapter" data-level="6.2.2" data-path="viz-1.html"><a href="viz-1.html#слои"><i class="fa fa-check"></i><b>6.2.2</b> Слои</a></li>
<li class="chapter" data-level="6.2.3" data-path="viz-1.html"><a href="viz-1.html#aes"><i class="fa fa-check"></i><b>6.2.3</b> <code>aes()</code></a></li>
<li class="chapter" data-level="6.2.4" data-path="viz-1.html"><a href="viz-1.html#оформление"><i class="fa fa-check"></i><b>6.2.4</b> Оформление</a></li>
<li class="chapter" data-level="6.2.5" data-path="viz-1.html"><a href="viz-1.html#логарифмические-шкалы"><i class="fa fa-check"></i><b>6.2.5</b> Логарифмические шкалы</a></li>
<li class="chapter" data-level="6.2.6" data-path="viz-1.html"><a href="viz-1.html#annotate"><i class="fa fa-check"></i><b>6.2.6</b> <code>annotate()</code></a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="viz-1.html"><a href="viz-1.html#столбчатые-диаграммы-barplots"><i class="fa fa-check"></i><b>6.3</b> Столбчатые диаграммы (barplots)</a></li>
<li class="chapter" data-level="6.4" data-path="viz-1.html"><a href="viz-1.html#факторы"><i class="fa fa-check"></i><b>6.4</b> Факторы</a></li>
<li class="chapter" data-level="6.5" data-path="viz-1.html"><a href="viz-1.html#дотплот"><i class="fa fa-check"></i><b>6.5</b> Дотплот</a></li>
<li class="chapter" data-level="6.6" data-path="viz-1.html"><a href="viz-1.html#гистограммы"><i class="fa fa-check"></i><b>6.6</b> Гистограммы</a></li>
<li class="chapter" data-level="6.7" data-path="viz-1.html"><a href="viz-1.html#функции-плотности"><i class="fa fa-check"></i><b>6.7</b> Функции плотности</a></li>
<li class="chapter" data-level="6.8" data-path="viz-1.html"><a href="viz-1.html#точки-джиттер-jitter-вайолинплот-violinplot-ящики-с-усами-boxplot"><i class="fa fa-check"></i><b>6.8</b> Точки, джиттер (jitter), вайолинплот (violinplot), ящики с усами (boxplot),</a></li>
<li class="chapter" data-level="6.9" data-path="viz-1.html"><a href="viz-1.html#фасетизация"><i class="fa fa-check"></i><b>6.9</b> Фасетизация</a></li>
<li class="chapter" data-level="6.10" data-path="viz-1.html"><a href="viz-1.html#визуализация-комбинаций-признаков"><i class="fa fa-check"></i><b>6.10</b> Визуализация комбинаций признаков</a>
<ul>
<li class="chapter" data-level="6.10.1" data-path="viz-1.html"><a href="viz-1.html#потоковая-диаграмма-sankey-diagram"><i class="fa fa-check"></i><b>6.10.1</b> Потоковая Диаграмма (Sankey diagram)</a></li>
<li class="chapter" data-level="6.10.2" data-path="viz-1.html"><a href="viz-1.html#upset-plot"><i class="fa fa-check"></i><b>6.10.2</b> UpSet Plot</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="strings.html"><a href="strings.html"><i class="fa fa-check"></i><b>7</b> Работа со строками</a>
<ul>
<li class="chapter" data-level="7.1" data-path="strings.html"><a href="strings.html#работа-со-строками-в-r"><i class="fa fa-check"></i><b>7.1</b> Работа со строками в R</a></li>
<li class="chapter" data-level="7.2" data-path="strings.html"><a href="strings.html#как-получить-строку"><i class="fa fa-check"></i><b>7.2</b> Как получить строку?</a></li>
<li class="chapter" data-level="7.3" data-path="strings.html"><a href="strings.html#соединение-и-разделение-строк"><i class="fa fa-check"></i><b>7.3</b> Соединение и разделение строк</a></li>
<li class="chapter" data-level="7.4" data-path="strings.html"><a href="strings.html#количество-символов"><i class="fa fa-check"></i><b>7.4</b> Количество символов</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="strings.html"><a href="strings.html#подсчет-количества-символов"><i class="fa fa-check"></i><b>7.4.1</b> Подсчет количества символов</a></li>
<li class="chapter" data-level="7.4.2" data-path="strings.html"><a href="strings.html#подгонка-количества-символов"><i class="fa fa-check"></i><b>7.4.2</b> Подгонка количества символов</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="strings.html"><a href="strings.html#сортировка"><i class="fa fa-check"></i><b>7.5</b> Сортировка</a></li>
<li class="chapter" data-level="7.6" data-path="strings.html"><a href="strings.html#поиск-подстроки"><i class="fa fa-check"></i><b>7.6</b> Поиск подстроки</a></li>
<li class="chapter" data-level="7.7" data-path="strings.html"><a href="strings.html#изменение-строк"><i class="fa fa-check"></i><b>7.7</b> Изменение строк</a>
<ul>
<li class="chapter" data-level="7.7.1" data-path="strings.html"><a href="strings.html#изменение-регистра"><i class="fa fa-check"></i><b>7.7.1</b> Изменение регистра</a></li>
<li class="chapter" data-level="7.7.2" data-path="strings.html"><a href="strings.html#выделение-подстроки"><i class="fa fa-check"></i><b>7.7.2</b> Выделение подстроки</a></li>
<li class="chapter" data-level="7.7.3" data-path="strings.html"><a href="strings.html#замена-подстроки"><i class="fa fa-check"></i><b>7.7.3</b> Замена подстроки</a></li>
<li class="chapter" data-level="7.7.4" data-path="strings.html"><a href="strings.html#удаление-подстроки"><i class="fa fa-check"></i><b>7.7.4</b> Удаление подстроки</a></li>
<li class="chapter" data-level="7.7.5" data-path="strings.html"><a href="strings.html#транслитерация-строк"><i class="fa fa-check"></i><b>7.7.5</b> Транслитерация строк</a></li>
</ul></li>
<li class="chapter" data-level="7.8" data-path="strings.html"><a href="strings.html#регулярные-выражения"><i class="fa fa-check"></i><b>7.8</b> Регулярные выражения</a>
<ul>
<li class="chapter" data-level="7.8.1" data-path="strings.html"><a href="strings.html#экранирование-метасимволов"><i class="fa fa-check"></i><b>7.8.1</b> Экранирование метасимволов</a></li>
<li class="chapter" data-level="7.8.2" data-path="strings.html"><a href="strings.html#классы-знаков"><i class="fa fa-check"></i><b>7.8.2</b> Классы знаков</a></li>
<li class="chapter" data-level="7.8.3" data-path="strings.html"><a href="strings.html#квантификация"><i class="fa fa-check"></i><b>7.8.3</b> Квантификация</a></li>
<li class="chapter" data-level="7.8.4" data-path="strings.html"><a href="strings.html#позиционная-проверка-look-arounds"><i class="fa fa-check"></i><b>7.8.4</b> Позиционная проверка (look arounds)</a></li>
</ul></li>
<li class="chapter" data-level="7.9" data-path="strings.html"><a href="strings.html#определение-языка"><i class="fa fa-check"></i><b>7.9</b> Определение языка</a></li>
<li class="chapter" data-level="7.10" data-path="strings.html"><a href="strings.html#расстояния-между-строками"><i class="fa fa-check"></i><b>7.10</b> Расстояния между строками</a></li>
<li class="chapter" data-level="7.11" data-path="strings.html"><a href="strings.html#дополнительные-задания"><i class="fa fa-check"></i><b>7.11</b> Дополнительные задания:</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="data-presentation.html"><a href="data-presentation.html"><i class="fa fa-check"></i><b>8</b> Представление данных: <code>rmarkdown</code></a>
<ul>
<li class="chapter" data-level="8.1" data-path="data-presentation.html"><a href="data-presentation.html#rmarkdown"><i class="fa fa-check"></i><b>8.1</b> <code>rmarkdown</code></a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="data-presentation.html"><a href="data-presentation.html#установка"><i class="fa fa-check"></i><b>8.1.1</b> Установка</a></li>
<li class="chapter" data-level="8.1.2" data-path="data-presentation.html"><a href="data-presentation.html#составляющие-rmarkdown-документа"><i class="fa fa-check"></i><b>8.1.2</b> Составляющие <code>rmarkdown</code>-документа</a></li>
<li class="chapter" data-level="8.1.3" data-path="data-presentation.html"><a href="data-presentation.html#пример-rmarkdown-документа"><i class="fa fa-check"></i><b>8.1.3</b> Пример <code>rmarkdown</code>-документа</a></li>
<li class="chapter" data-level="8.1.4" data-path="data-presentation.html"><a href="data-presentation.html#markdown"><i class="fa fa-check"></i><b>8.1.4</b> <code>Markdown</code></a></li>
<li class="chapter" data-level="8.1.5" data-path="data-presentation.html"><a href="data-presentation.html#pandoc"><i class="fa fa-check"></i><b>8.1.5</b> <code>Pandoc</code></a></li>
<li class="chapter" data-level="8.1.6" data-path="data-presentation.html"><a href="data-presentation.html#code-chunks"><i class="fa fa-check"></i><b>8.1.6</b> Code chunks</a></li>
<li class="chapter" data-level="8.1.7" data-path="data-presentation.html"><a href="data-presentation.html#yaml-шапка"><i class="fa fa-check"></i><b>8.1.7</b> YAML шапка</a></li>
<li class="chapter" data-level="8.1.8" data-path="data-presentation.html"><a href="data-presentation.html#где-хостить-.html"><i class="fa fa-check"></i><b>8.1.8</b> Где хостить <code>.html</code>?</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="data-presentation.html"><a href="data-presentation.html#бывают-и-другие-способы-представления-данных"><i class="fa fa-check"></i><b>8.2</b> Бывают и другие способы представления данных</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="работа-с-текстами-gutenbergr-tidytext-stopwords.html"><a href="работа-с-текстами-gutenbergr-tidytext-stopwords.html"><i class="fa fa-check"></i><b>9</b> Работа с текстами: <code>gutenbergr</code>, <code>tidytext</code>, <code>stopwords</code></a>
<ul>
<li class="chapter" data-level="9.1" data-path="работа-с-текстами-gutenbergr-tidytext-stopwords.html"><a href="работа-с-текстами-gutenbergr-tidytext-stopwords.html#загрузка-текста-в-r"><i class="fa fa-check"></i><b>9.1</b> Загрузка текста в R</a></li>
<li class="chapter" data-level="9.2" data-path="работа-с-текстами-gutenbergr-tidytext-stopwords.html"><a href="работа-с-текстами-gutenbergr-tidytext-stopwords.html#пакет-gutenbergr"><i class="fa fa-check"></i><b>9.2</b> Пакет <code>gutenbergr</code></a></li>
<li class="chapter" data-level="9.3" data-path="работа-с-текстами-gutenbergr-tidytext-stopwords.html"><a href="работа-с-текстами-gutenbergr-tidytext-stopwords.html#библиотека-tidytext"><i class="fa fa-check"></i><b>9.3</b> Библиотека <code>tidytext</code></a></li>
<li class="chapter" data-level="9.4" data-path="работа-с-текстами-gutenbergr-tidytext-stopwords.html"><a href="работа-с-текстами-gutenbergr-tidytext-stopwords.html#пакет-stopwords"><i class="fa fa-check"></i><b>9.4</b> Пакет <code>stopwords</code></a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="работа-со-временем-lubridate.html"><a href="работа-со-временем-lubridate.html"><i class="fa fa-check"></i><b>10</b> Работа со временем: <code>lubridate</code></a>
<ul>
<li class="chapter" data-level="10.1" data-path="работа-со-временем-lubridate.html"><a href="работа-со-временем-lubridate.html#создание-даты"><i class="fa fa-check"></i><b>10.1</b> Создание даты</a></li>
<li class="chapter" data-level="10.2" data-path="работа-со-временем-lubridate.html"><a href="работа-со-временем-lubridate.html#извлечение-компонентов-даты"><i class="fa fa-check"></i><b>10.2</b> Извлечение компонентов даты</a></li>
<li class="chapter" data-level="10.3" data-path="работа-со-временем-lubridate.html"><a href="работа-со-временем-lubridate.html#операции-с-датами"><i class="fa fa-check"></i><b>10.3</b> Операции с датами</a></li>
<li class="chapter" data-level="10.4" data-path="работа-со-временем-lubridate.html"><a href="работа-со-временем-lubridate.html#визуализация-времени-данные-левада-центра"><i class="fa fa-check"></i><b>10.4</b> Визуализация времени: данные Левада-центра</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="работа-с-геоданными-leaflet.html"><a href="работа-с-геоданными-leaflet.html"><i class="fa fa-check"></i><b>11</b> Работа с геоданными: <code>leaflet</code></a>
<ul>
<li class="chapter" data-level="11.1" data-path="работа-с-геоданными-leaflet.html"><a href="работа-с-геоданными-leaflet.html#векторная-и-растровая-графика"><i class="fa fa-check"></i><b>11.1</b> Векторная и растровая графика</a></li>
<li class="chapter" data-level="11.2" data-path="работа-с-геоданными-leaflet.html"><a href="работа-с-геоданными-leaflet.html#картографические-примитивы"><i class="fa fa-check"></i><b>11.2</b> Картографические примитивы</a></li>
<li class="chapter" data-level="11.3" data-path="работа-с-геоданными-leaflet.html"><a href="работа-с-геоданными-leaflet.html#leaflet"><i class="fa fa-check"></i><b>11.3</b> <code>leaflet</code></a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="работа-с-геоданными-leaflet.html"><a href="работа-с-геоданными-leaflet.html#csv-файлы"><i class="fa fa-check"></i><b>11.3.1</b> <code>.csv</code> файлы</a></li>
<li class="chapter" data-level="11.3.2" data-path="работа-с-геоданными-leaflet.html"><a href="работа-с-геоданными-leaflet.html#комбинация-карт-leafsync"><i class="fa fa-check"></i><b>11.3.2</b> Комбинация карт: <code>leafsync</code></a></li>
<li class="chapter" data-level="11.3.3" data-path="работа-с-геоданными-leaflet.html"><a href="работа-с-геоданными-leaflet.html#работа-с-.geojson"><i class="fa fa-check"></i><b>11.3.3</b> Работа с <code>.geojson</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="работа-со-списками.html"><a href="работа-со-списками.html"><i class="fa fa-check"></i><b>12</b> Работа со списками</a>
<ul>
<li class="chapter" data-level="12.1" data-path="работа-со-списками.html"><a href="работа-со-списками.html#что-такое-списки"><i class="fa fa-check"></i><b>12.1</b> Что такое списки?</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="работа-со-списками.html"><a href="работа-со-списками.html#превращение-json-в-список-и-обратно"><i class="fa fa-check"></i><b>12.1.1</b> Превращение JSON в список и обратно</a></li>
<li class="chapter" data-level="12.1.2" data-path="работа-со-списками.html"><a href="работа-со-списками.html#превращение-.xml-в-список-и-обратно"><i class="fa fa-check"></i><b>12.1.2</b> Превращение <code>.xml</code> в список и обратно</a></li>
<li class="chapter" data-level="12.1.3" data-path="работа-со-списками.html"><a href="работа-со-списками.html#просмотр-списков-в-r"><i class="fa fa-check"></i><b>12.1.3</b> Просмотр списков в R</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="работа-со-списками.html"><a href="работа-со-списками.html#пакет-purrr"><i class="fa fa-check"></i><b>12.2</b> Пакет <code>purrr</code></a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="работа-со-списками.html"><a href="работа-со-списками.html#функция-map-и-map..."><i class="fa fa-check"></i><b>12.2.1</b> Функция <code>map()</code> и <code>map...()</code></a></li>
<li class="chapter" data-level="12.2.2" data-path="работа-со-списками.html"><a href="работа-со-списками.html#фильтрация-списков"><i class="fa fa-check"></i><b>12.2.2</b> Фильтрация списков</a></li>
<li class="chapter" data-level="12.2.3" data-path="работа-со-списками.html"><a href="работа-со-списками.html#операции-со-списками"><i class="fa fa-check"></i><b>12.2.3</b> Операции со списками</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="описательная-статистика-распределения.html"><a href="описательная-статистика-распределения.html"><i class="fa fa-check"></i><b>13</b> Описательная статистика, распределения</a>
<ul>
<li class="chapter" data-level="13.1" data-path="описательная-статистика-распределения.html"><a href="описательная-статистика-распределения.html#описательная-статистика"><i class="fa fa-check"></i><b>13.1</b> Описательная статистика</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="описательная-статистика-распределения.html"><a href="описательная-статистика-распределения.html#категориальные-переменные"><i class="fa fa-check"></i><b>13.1.1</b> Категориальные переменные</a></li>
<li class="chapter" data-level="13.1.2" data-path="описательная-статистика-распределения.html"><a href="описательная-статистика-распределения.html#числовые-переменные"><i class="fa fa-check"></i><b>13.1.2</b> Числовые переменные</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="описательная-статистика-распределения.html"><a href="описательная-статистика-распределения.html#от-частотности-к-вероятности"><i class="fa fa-check"></i><b>13.2</b> От частотности к вероятности</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="описательная-статистика-распределения.html"><a href="описательная-статистика-распределения.html#категориальная-переменная"><i class="fa fa-check"></i><b>13.2.1</b> Категориальная переменная</a></li>
<li class="chapter" data-level="13.2.2" data-path="описательная-статистика-распределения.html"><a href="описательная-статистика-распределения.html#числовая-переменная"><i class="fa fa-check"></i><b>13.2.2</b> Числовая переменная</a></li>
<li class="chapter" data-level="13.2.3" data-path="описательная-статистика-распределения.html"><a href="описательная-статистика-распределения.html#распределения"><i class="fa fa-check"></i><b>13.2.3</b> Распределения</a></li>
<li class="chapter" data-level="13.2.4" data-path="описательная-статистика-распределения.html"><a href="описательная-статистика-распределения.html#давайте-посчитаем-вероятности"><i class="fa fa-check"></i><b>13.2.4</b> Давайте посчитаем вероятности</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="проверка-статистических-гипотез.html"><a href="проверка-статистических-гипотез.html"><i class="fa fa-check"></i><b>14</b> Проверка статистических гипотез</a>
<ul>
<li class="chapter" data-level="14.1" data-path="проверка-статистических-гипотез.html"><a href="проверка-статистических-гипотез.html#о-статистике"><i class="fa fa-check"></i><b>14.1</b> О статистике</a></li>
<li class="chapter" data-level="14.2" data-path="проверка-статистических-гипотез.html"><a href="проверка-статистических-гипотез.html#проверка-нулевой-гипотезы"><i class="fa fa-check"></i><b>14.2</b> Проверка нулевой гипотезы</a></li>
<li class="chapter" data-level="14.3" data-path="проверка-статистических-гипотез.html"><a href="проверка-статистических-гипотез.html#классификация-статистических-тестов"><i class="fa fa-check"></i><b>14.3</b> Классификация статистических тестов</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="проверка-статистических-гипотез.html"><a href="проверка-статистических-гипотез.html#количество-выборок"><i class="fa fa-check"></i><b>14.3.1</b> Количество выборок</a></li>
<li class="chapter" data-level="14.3.2" data-path="проверка-статистических-гипотез.html"><a href="проверка-статистических-гипотез.html#направление"><i class="fa fa-check"></i><b>14.3.2</b> Направление</a></li>
<li class="chapter" data-level="14.3.3" data-path="проверка-статистических-гипотез.html"><a href="проверка-статистических-гипотез.html#парные-vs.-непарные"><i class="fa fa-check"></i><b>14.3.3</b> Парные vs. непарные</a></li>
<li class="chapter" data-level="14.3.4" data-path="проверка-статистических-гипотез.html"><a href="проверка-статистических-гипотез.html#параметрические-vs.-непараметрические"><i class="fa fa-check"></i><b>14.3.4</b> Параметрические vs. непараметрические</a></li>
<li class="chapter" data-level="14.3.5" data-path="проверка-статистических-гипотез.html"><a href="проверка-статистических-гипотез.html#классификация-тестов"><i class="fa fa-check"></i><b>14.3.5</b> Классификация тестов</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="проверка-статистических-гипотез.html"><a href="проверка-статистических-гипотез.html#одновыборочные-тесты"><i class="fa fa-check"></i><b>14.4</b> Одновыборочные тесты</a>
<ul>
<li class="chapter" data-level="14.4.1" data-path="проверка-статистических-гипотез.html"><a href="проверка-статистических-гипотез.html#биномиальный-тест"><i class="fa fa-check"></i><b>14.4.1</b> Биномиальный тест</a></li>
<li class="chapter" data-level="14.4.2" data-path="проверка-статистических-гипотез.html"><a href="проверка-статистических-гипотез.html#одновыборочный-t-тест"><i class="fa fa-check"></i><b>14.4.2</b> Одновыборочный t-тест</a></li>
<li class="chapter" data-level="14.4.3" data-path="проверка-статистических-гипотез.html"><a href="проверка-статистических-гипотез.html#тест-уилкоксона"><i class="fa fa-check"></i><b>14.4.3</b> Тест Уилкоксона</a></li>
</ul></li>
<li class="chapter" data-level="14.5" data-path="проверка-статистических-гипотез.html"><a href="проверка-статистических-гипотез.html#двухвыборочные-тесты"><i class="fa fa-check"></i><b>14.5</b> Двухвыборочные тесты</a>
<ul>
<li class="chapter" data-level="14.5.1" data-path="проверка-статистических-гипотез.html"><a href="проверка-статистических-гипотез.html#двухвыборочный-t-тест"><i class="fa fa-check"></i><b>14.5.1</b> Двухвыборочный t-тест</a></li>
<li class="chapter" data-level="14.5.2" data-path="проверка-статистических-гипотез.html"><a href="проверка-статистических-гипотез.html#двухвыборочный-парный-t-тест"><i class="fa fa-check"></i><b>14.5.2</b> Двухвыборочный парный t-тест</a></li>
<li class="chapter" data-level="14.5.3" data-path="проверка-статистических-гипотез.html"><a href="проверка-статистических-гипотез.html#критерий-манна-уитни"><i class="fa fa-check"></i><b>14.5.3</b> Критерий Манна-Уитни</a></li>
<li class="chapter" data-level="14.5.4" data-path="проверка-статистических-гипотез.html"><a href="проверка-статистических-гипотез.html#критерий-χ²-тест-фишера"><i class="fa fa-check"></i><b>14.5.4</b> Критерий χ², тест Фишера</a></li>
<li class="chapter" data-level="14.5.5" data-path="проверка-статистических-гипотез.html"><a href="проверка-статистических-гипотез.html#критерий-мак-немара"><i class="fa fa-check"></i><b>14.5.5</b> Критерий Мак Немара</a></li>
</ul></li>
<li class="chapter" data-level="14.6" data-path="проверка-статистических-гипотез.html"><a href="проверка-статистических-гипотез.html#послесловие"><i class="fa fa-check"></i><b>14.6</b> Послесловие</a></li>
<li class="chapter" data-level="14.7" data-path="проверка-статистических-гипотез.html"><a href="проверка-статистических-гипотез.html#рассказы-чехова-и-зощенко"><i class="fa fa-check"></i><b>14.7</b> Рассказы Чехова и Зощенко</a>
<ul>
<li class="chapter" data-level="14.7.1" data-path="проверка-статистических-гипотез.html"><a href="проверка-статистических-гипотез.html#section"><i class="fa fa-check"></i><b>14.7.1</b> </a></li>
<li class="chapter" data-level="14.7.2" data-path="проверка-статистических-гипотез.html"><a href="проверка-статистических-гипотез.html#section-1"><i class="fa fa-check"></i><b>14.7.2</b> </a></li>
<li class="chapter" data-level="14.7.3" data-path="проверка-статистических-гипотез.html"><a href="проверка-статистических-гипотез.html#section-2"><i class="fa fa-check"></i><b>14.7.3</b> </a></li>
<li class="chapter" data-level="14.7.4" data-path="проверка-статистических-гипотез.html"><a href="проверка-статистических-гипотез.html#section-3"><i class="fa fa-check"></i><b>14.7.4</b> </a></li>
</ul></li>
<li class="chapter" data-level="14.8" data-path="проверка-статистических-гипотез.html"><a href="проверка-статистических-гипотез.html#obamacare"><i class="fa fa-check"></i><b>14.8</b> Obamacare</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="корреляция-и-регрессия.html"><a href="корреляция-и-регрессия.html"><i class="fa fa-check"></i><b>15</b> Корреляция и регрессия</a>
<ul>
<li class="chapter" data-level="15.1" data-path="корреляция-и-регрессия.html"><a href="корреляция-и-регрессия.html#дисперсия-и-стандартное-отклонение"><i class="fa fa-check"></i><b>15.1</b> Дисперсия и стандартное отклонение</a></li>
<li class="chapter" data-level="15.2" data-path="корреляция-и-регрессия.html"><a href="корреляция-и-регрессия.html#z-преобразование"><i class="fa fa-check"></i><b>15.2</b> z-преобразование</a></li>
<li class="chapter" data-level="15.3" data-path="корреляция-и-регрессия.html"><a href="корреляция-и-регрессия.html#ковариация"><i class="fa fa-check"></i><b>15.3</b> Ковариация</a></li>
<li class="chapter" data-level="15.4" data-path="корреляция-и-регрессия.html"><a href="корреляция-и-регрессия.html#корреляция"><i class="fa fa-check"></i><b>15.4</b> Корреляция</a>
<ul>
<li class="chapter" data-level="15.4.1" data-path="корреляция-и-регрессия.html"><a href="корреляция-и-регрессия.html#корреляция-пирсона"><i class="fa fa-check"></i><b>15.4.1</b> Корреляция Пирсона</a></li>
<li class="chapter" data-level="15.4.2" data-path="корреляция-и-регрессия.html"><a href="корреляция-и-регрессия.html#ранговые-корреляции-спирмана-и-кендалла"><i class="fa fa-check"></i><b>15.4.2</b> Ранговые корреляции Спирмана и Кендалла</a></li>
</ul></li>
<li class="chapter" data-level="15.5" data-path="корреляция-и-регрессия.html"><a href="корреляция-и-регрессия.html#регрессионный-анализ"><i class="fa fa-check"></i><b>15.5</b> Регрессионный анализ</a>
<ul>
<li class="chapter" data-level="15.5.1" data-path="корреляция-и-регрессия.html"><a href="корреляция-и-регрессия.html#основы"><i class="fa fa-check"></i><b>15.5.1</b> Основы</a></li>
<li class="chapter" data-level="15.5.2" data-path="корреляция-и-регрессия.html"><a href="корреляция-и-регрессия.html#первая-регрессия"><i class="fa fa-check"></i><b>15.5.2</b> Первая регрессия</a></li>
<li class="chapter" data-level="15.5.3" data-path="корреляция-и-регрессия.html"><a href="корреляция-и-регрессия.html#категориальные-переменные-1"><i class="fa fa-check"></i><b>15.5.3</b> Категориальные переменные</a></li>
<li class="chapter" data-level="15.5.4" data-path="корреляция-и-регрессия.html"><a href="корреляция-и-регрессия.html#множественная-регрессия"><i class="fa fa-check"></i><b>15.5.4</b> Множественная регрессия</a></li>
<li class="chapter" data-level="15.5.5" data-path="корреляция-и-регрессия.html"><a href="корреляция-и-регрессия.html#сравнение-моделей"><i class="fa fa-check"></i><b>15.5.5</b> Сравнение моделей</a></li>
<li class="chapter" data-level="15.5.6" data-path="корреляция-и-регрессия.html"><a href="корреляция-и-регрессия.html#послесловие-1"><i class="fa fa-check"></i><b>15.5.6</b> Послесловие</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="16" data-path="работа-статистического-детектива.html"><a href="работа-статистического-детектива.html"><i class="fa fa-check"></i><b>16</b> Работа статистического детектива</a>
<ul>
<li class="chapter" data-level="16.1" data-path="работа-статистического-детектива.html"><a href="работа-статистического-детектива.html#введение"><i class="fa fa-check"></i><b>16.1</b> Введение</a></li>
<li class="chapter" data-level="16.2" data-path="работа-статистического-детектива.html"><a href="работа-статистического-детектива.html#возможно-ли-такое-среднее"><i class="fa fa-check"></i><b>16.2</b> Возможно ли такое среднее?</a></li>
<li class="chapter" data-level="16.3" data-path="работа-статистического-детектива.html"><a href="работа-статистического-детектива.html#пакет-statcheck"><i class="fa fa-check"></i><b>16.3</b> Пакет <code>statcheck</code></a></li>
<li class="chapter" data-level="16.4" data-path="работа-статистического-детектива.html"><a href="работа-статистического-детектива.html#пакет-digitize"><i class="fa fa-check"></i><b>16.4</b> Пакет <code>digitize</code></a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="tasks.html"><a href="tasks.html"><i class="fa fa-check"></i><b>17</b> Задания</a>
<ul>
<li class="chapter" data-level="17.1" data-path="tasks.html"><a href="tasks.html#task_begin"><i class="fa fa-check"></i><b>17.1</b> Начало работы в R</a></li>
<li class="chapter" data-level="17.2" data-path="tasks.html"><a href="tasks.html#task_new_vecs"><i class="fa fa-check"></i><b>17.2</b> Создание векторов</a></li>
<li class="chapter" data-level="17.3" data-path="tasks.html"><a href="tasks.html#task_coer"><i class="fa fa-check"></i><b>17.3</b> Приведение типов</a></li>
<li class="chapter" data-level="17.4" data-path="tasks.html"><a href="tasks.html#task_vec_ion"><i class="fa fa-check"></i><b>17.4</b> Векторизация</a></li>
<li class="chapter" data-level="17.5" data-path="tasks.html"><a href="tasks.html#task_vec_ind"><i class="fa fa-check"></i><b>17.5</b> Индексирование векторов</a></li>
<li class="chapter" data-level="17.6" data-path="tasks.html"><a href="tasks.html#task_matrix"><i class="fa fa-check"></i><b>17.6</b> Матрицы</a></li>
<li class="chapter" data-level="17.7" data-path="tasks.html"><a href="tasks.html#task_list"><i class="fa fa-check"></i><b>17.7</b> Списки</a></li>
<li class="chapter" data-level="17.8" data-path="tasks.html"><a href="tasks.html#task_df"><i class="fa fa-check"></i><b>17.8</b> Датафрейм</a></li>
<li class="chapter" data-level="17.9" data-path="tasks.html"><a href="tasks.html#task_if"><i class="fa fa-check"></i><b>17.9</b> Условные конструкции</a></li>
<li class="chapter" data-level="17.10" data-path="tasks.html"><a href="tasks.html#task_function"><i class="fa fa-check"></i><b>17.10</b> Создание функций</a></li>
<li class="chapter" data-level="17.11" data-path="tasks.html"><a href="tasks.html#task_apply"><i class="fa fa-check"></i><b>17.11</b> Семейство функций apply()</a></li>
<li class="chapter" data-level="17.12" data-path="tasks.html"><a href="tasks.html#task_pipe"><i class="fa fa-check"></i><b>17.12</b> magrittr::<code>%&gt;%</code></a></li>
<li class="chapter" data-level="17.13" data-path="tasks.html"><a href="tasks.html#task_arr"><i class="fa fa-check"></i><b>17.13</b> Сортировка строк: <code>dplyr::arrange()</code></a></li>
<li class="chapter" data-level="17.14" data-path="tasks.html"><a href="tasks.html#task_dist"><i class="fa fa-check"></i><b>17.14</b> Уникальные значения: <code>dplyr::distinct()</code></a></li>
<li class="chapter" data-level="17.15" data-path="tasks.html"><a href="tasks.html#task_mutate"><i class="fa fa-check"></i><b>17.15</b> Создание колонок: <code>dplyr::mutate()</code> и <code>dplyr::transmute()</code></a></li>
<li class="chapter" data-level="17.16" data-path="tasks.html"><a href="tasks.html#task_group_by"><i class="fa fa-check"></i><b>17.16</b> Агрегация: <code>dplyr::group_by() %&gt;% summarise()</code></a></li>
<li class="chapter" data-level="17.17" data-path="tasks.html"><a href="tasks.html#task_across"><i class="fa fa-check"></i><b>17.17</b> Операции с несколькими колонками: <code>across()</code></a></li>
<li class="chapter" data-level="17.18" data-path="tasks.html"><a href="tasks.html#соединение-датафреймов-_join-task_join"><i class="fa fa-check"></i><b>17.18</b> Соединение датафреймов: *_join {#task_join}</a></li>
<li class="chapter" data-level="17.19" data-path="tasks.html"><a href="tasks.html#task_join"><i class="fa fa-check"></i><b>17.19</b> Tidy data</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="solutions.html"><a href="solutions.html"><i class="fa fa-check"></i><b>18</b> Решения заданий</a>
<ul>
<li class="chapter" data-level="18.1" data-path="solutions.html"><a href="solutions.html#solution_coer"><i class="fa fa-check"></i><b>18.1</b> Приведение типов</a></li>
<li class="chapter" data-level="18.2" data-path="solutions.html"><a href="solutions.html#solution_vec_ion"><i class="fa fa-check"></i><b>18.2</b> Векторизация</a></li>
<li class="chapter" data-level="18.3" data-path="solutions.html"><a href="solutions.html#solution_vec_ind"><i class="fa fa-check"></i><b>18.3</b> Индексирование векторов</a></li>
<li class="chapter" data-level="18.4" data-path="solutions.html"><a href="solutions.html#solution_matrix"><i class="fa fa-check"></i><b>18.4</b> Матрицы</a></li>
<li class="chapter" data-level="18.5" data-path="solutions.html"><a href="solutions.html#solution_list"><i class="fa fa-check"></i><b>18.5</b> Списки</a></li>
<li class="chapter" data-level="18.6" data-path="solutions.html"><a href="solutions.html#solution_df"><i class="fa fa-check"></i><b>18.6</b> Датафрейм</a></li>
<li class="chapter" data-level="18.7" data-path="solutions.html"><a href="solutions.html#solution_if"><i class="fa fa-check"></i><b>18.7</b> Условные конструкции</a></li>
<li class="chapter" data-level="18.8" data-path="solutions.html"><a href="solutions.html#solution_function"><i class="fa fa-check"></i><b>18.8</b> Создание функций</a></li>
<li class="chapter" data-level="18.9" data-path="solutions.html"><a href="solutions.html#solution_apply"><i class="fa fa-check"></i><b>18.9</b> Семейство функций apply()</a></li>
<li class="chapter" data-level="18.10" data-path="solutions.html"><a href="solutions.html#solution_pipe"><i class="fa fa-check"></i><b>18.10</b> magrittr::<code>%&gt;%</code></a></li>
<li class="chapter" data-level="18.11" data-path="solutions.html"><a href="solutions.html#solution_arr"><i class="fa fa-check"></i><b>18.11</b> Сортировка строк: <code>dplyr::arrange()</code></a></li>
<li class="chapter" data-level="18.12" data-path="solutions.html"><a href="solutions.html#solution_dist"><i class="fa fa-check"></i><b>18.12</b> Уникальные значения: <code>dplyr::distinct()</code></a></li>
<li class="chapter" data-level="18.13" data-path="solutions.html"><a href="solutions.html#solution_mutate"><i class="fa fa-check"></i><b>18.13</b> Создание колонок: <code>dplyr::mutate()</code> и <code>dplyr::transmute()</code></a></li>
<li class="chapter" data-level="18.14" data-path="solutions.html"><a href="solutions.html#solution_group_by"><i class="fa fa-check"></i><b>18.14</b> Агрегация: <code>dplyr::group_by() %&gt;% summarise()</code></a></li>
<li class="chapter" data-level="18.15" data-path="solutions.html"><a href="solutions.html#solution_across"><i class="fa fa-check"></i><b>18.15</b> Операции с несколькими колонками: <code>across()</code></a></li>
<li class="chapter" data-level="18.16" data-path="solutions.html"><a href="solutions.html#соединение-датафреймов-_join-solution_join"><i class="fa fa-check"></i><b>18.16</b> Соединение датафреймов: *_join {#solution_join}</a></li>
<li class="chapter" data-level="18.17" data-path="solutions.html"><a href="solutions.html#solution_join"><i class="fa fa-check"></i><b>18.17</b> Tidy data</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ссылки-на-литературу.html"><a href="ссылки-на-литературу.html"><i class="fa fa-check"></i>Ссылки на литературу</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Наука о данных в R для программы Цифровых гуманитарных исследований</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="корреляция-и-регрессия" class="section level1" number="15">
<h1><span class="header-section-number">15</span> Корреляция и регрессия</h1>
<div id="дисперсия-и-стандартное-отклонение" class="section level2" number="15.1">
<h2><span class="header-section-number">15.1</span> Дисперсия и стандартное отклонение</h2>
<p><strong>Дисперсия</strong> — мера разброса значений наблюдений относительно среднего.</p>
<p><span class="math display">\[\sigma^2_X = \frac{\sum_{i = 1}^n(x_i - \bar{x})^2}{n - 1},\]</span></p>
<p>где</p>
<ul>
<li><span class="math inline">\(x_1, ..., x_n\)</span> — наблюдения;</li>
<li><span class="math inline">\(\bar{x}\)</span> — среднее всех наблюдений;</li>
<li><span class="math inline">\(X\)</span> — вектор всех наблюдений;</li>
<li><span class="math inline">\(n\)</span> — количество наблюдений.</li>
</ul>
<p>Представим, что у нас есть следующие данные:</p>
<p><img src="DS_for_DH_files/figure-html/unnamed-chunk-590-1.png" width="672" /></p>
<p>Тогда дисперсия — это сумма квадратов расстояний от каждой точки до среднего выборки (пунктирная линия) разделенное на количество наблюдений - 1 (по духу эта мера — обычное среднее, но если вас инетересует разница смещенной и несмещенной оценки дисперсии, см. <a href="https://youtu.be/Cn0skMJ2F3c">видео</a>).</p>
<p><img src="DS_for_DH_files/figure-html/unnamed-chunk-591-1.png" width="672" /></p>
<p>Для того чтобы было понятнее, что такое дисперсия, давайте рассмотрим несколько расспределений с одним и тем же средним, но разными дисперсиями:</p>
<p><img src="DS_for_DH_files/figure-html/unnamed-chunk-592-1.png" width="672" /></p>
<p>В R дисперсию можно посчитать при помощи функции <code>var()</code><a href="#fn24" class="footnote-ref" id="fnref24"><sup>24</sup></a>.</p>
<div class="sourceCode" id="cb1125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1125-1"><a href="корреляция-и-регрессия.html#cb1125-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb1125-2"><a href="корреляция-и-регрессия.html#cb1125-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">20</span>, <span class="at">mean =</span> <span class="dv">50</span>, <span class="at">sd =</span> <span class="dv">10</span>)</span>
<span id="cb1125-3"><a href="корреляция-и-регрессия.html#cb1125-3" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(x)</span></code></pre></div>
<pre><code>[1] 172.2993</code></pre>
<p>Проверим, что функция выдает то же, что мы записали в формуле.</p>
<div class="sourceCode" id="cb1127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1127-1"><a href="корреляция-и-регрессия.html#cb1127-1" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(x) <span class="sc">==</span> <span class="fu">sum</span>((x <span class="sc">-</span> <span class="fu">mean</span>(x))<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span>(<span class="fu">length</span>(x)<span class="sc">-</span><span class="dv">1</span>)</span></code></pre></div>
<pre><code>[1] TRUE</code></pre>
<p>Так как дисперсия является квадратом отклонения, то часто вместо нее используют более интерпретируемое стандартное отклонение <span class="math inline">\(\sigma\)</span> — корень из дисперсии. В R ее можно посчитать при помощи функции <code>sd()</code>:</p>
<div class="sourceCode" id="cb1129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1129-1"><a href="корреляция-и-регрессия.html#cb1129-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(x)</span></code></pre></div>
<pre><code>[1] 13.12628</code></pre>
<div class="sourceCode" id="cb1131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1131-1"><a href="корреляция-и-регрессия.html#cb1131-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(x) <span class="sc">==</span> <span class="fu">sqrt</span>(<span class="fu">var</span>(x))</span></code></pre></div>
<pre><code>[1] TRUE</code></pre>
<div class="rmdtask">
<p>
Посчитайте дисперсию переменной <code>sleep_total</code> в датасете <code>msleep</code>, встроенный в <code>tidyverse</code>. Ответ округлите до двух знаков после запятой.
</p>
</div>
<form name="form_28559" onsubmit="return validate_form_28559()" method="post">
<input type="text" name="answer_28559"><br><input type="submit" value="check">
</form>
<p id="result_28559">
</p>
<script> function validate_form_28559() {var x, text; var x = document.forms["form_28559"]["answer_28559"].value;if (x == "19.81"){text = 'Correct';} else {text = 'I have a different answer';} document.getElementById('result_28559').innerHTML = text; return false;} </script>
<div class="rmdtask">
<p>
Посчитайте стандартное отклонение переменной <code>sleep_total</code> в датасете <code>msleep</code>, встроенный в <code>tidyverse</code>. Ответ округлите до двух знаков после запятой.
</p>
</div>
<form name="form_88261" onsubmit="return validate_form_88261()" method="post">
<input type="text" name="answer_88261"><br><input type="submit" value="check">
</form>
<p id="result_88261">
</p>
<script> function validate_form_88261() {var x, text; var x = document.forms["form_88261"]["answer_88261"].value;if (x == "4.45"){text = 'Correct';} else {text = 'I have a different answer';} document.getElementById('result_88261').innerHTML = text; return false;} </script>
</div>
<div id="z-преобразование" class="section level2" number="15.2">
<h2><span class="header-section-number">15.2</span> z-преобразование</h2>
<p><strong>z-преобразование</strong> (еще используют термин <strong>нормализация</strong>) — это способ представления данных в виде расстояний от среднего, измеряемых в стандартных отклонениях. Для того чтобы его получить, нужно из каждого наблюдения вычесть среднее и результат разделить на стандартное отклонение.</p>
<p><span class="math display">\[x_i = \frac{x_i - \bar{x}}{\sigma_X}\]</span></p>
<p>Если все наблюдения z-преобразовать, то получиться распределение с средним в 0 и стандартным отклонением 1 (или очень близко к ним).</p>
<p><img src="DS_for_DH_files/figure-html/unnamed-chunk-600-1.png" width="672" /></p>
<p>Само по себе <span class="math inline">\(z\)</span>-преобразование ничего особенного нам про данные не говорит. Однако это преобразование позволяет привести к “общему знаменателю” разные переменные. Т. е. это преобразование ничего нам не говорит про конкретный набор данных, но позволяет сравнивать разные наборы данных.</p>
<p>В R z-преобразование можно сделать при помощи функции <code>scale()</code>. Эта функция вовзращает матрицу, поэтому я использую индекс <code>[,1]</code>, чтобы результат был вектором.</p>
<div class="sourceCode" id="cb1133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1133-1"><a href="корреляция-и-регрессия.html#cb1133-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb1133-2"><a href="корреляция-и-регрессия.html#cb1133-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">20</span>, <span class="at">mean =</span> <span class="dv">50</span>, <span class="at">sd =</span> <span class="dv">10</span>)</span>
<span id="cb1133-3"><a href="корреляция-и-регрессия.html#cb1133-3" aria-hidden="true" tabindex="-1"></a><span class="fu">scale</span>(x)[,<span class="dv">1</span>]</span></code></pre></div>
<pre><code> [1]  0.8982271 -0.5764146  0.1304317  0.3359234  0.1617734 -0.2270593
 [7]  1.0053127 -0.2183246  1.3914857 -0.1939880  0.8478787  1.5958251
[13] -1.2042865 -0.3586002 -0.2477787  0.3382758 -0.3627629 -2.1699785
[19] -2.0054319  0.8594918</code></pre>
<p>Проверим, что функция выдает то же, что мы записали в формуле.</p>
<div class="sourceCode" id="cb1135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1135-1"><a href="корреляция-и-регрессия.html#cb1135-1" aria-hidden="true" tabindex="-1"></a><span class="fu">scale</span>(x)[,<span class="dv">1</span>] <span class="sc">==</span> (x<span class="sc">-</span><span class="fu">mean</span>(x))<span class="sc">/</span><span class="fu">sd</span>(x)</span></code></pre></div>
<pre><code> [1] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE
[16] TRUE TRUE TRUE TRUE TRUE</code></pre>
<div class="rmdtask">
<p>
Однаждый я заполучил градусник со шкалой Фаренгейта и целый год измерял температуру в Москве при помощи градусников с шкалой Фарингейта и Цельсия. <a href="https://raw.githubusercontent.com/agricolamz/DS_for_DH/master/data/moscow_average_temperature.csv">В датасет</a> записаны средние значения для каждого месяца. Постройте график нормализованных и ненормализованных измерений. Что можно сказать про измерения, сделанные разными термометрами?
</p>
</div>
<p><img src="DS_for_DH_files/figure-html/unnamed-chunk-604-1.png" width="672" /></p>
</div>
<div id="ковариация" class="section level2" number="15.3">
<h2><span class="header-section-number">15.3</span> Ковариация</h2>
<p><strong>Ковариация</strong> — эта мера ассоциации двух переменных.</p>
<p><span class="math display">\[cov(X, Y) = \frac{\sum_{i = 1}^n(x_i - \bar{x})(y_i-\bar{y})}{n - 1},\]</span></p>
<p>где</p>
<ul>
<li><span class="math inline">\((x_1, y_1), ..., (x_n, y_n)\)</span> — пары наблюдений;</li>
<li><span class="math inline">\(\bar{x}, \bar{y}\)</span> — средние наблюдений;</li>
<li><span class="math inline">\(X, Y\)</span> — векторы всех наблюдений;</li>
<li><span class="math inline">\(n\)</span> — количество наблюдений.</li>
</ul>
<p>Представим, что у нас есть следующие данные:</p>
<p><img src="DS_for_DH_files/figure-html/unnamed-chunk-605-1.png" width="672" /></p>
<p>Тогда, согласно формуле, для каждой точки вычисляется следующая площадь (пуктирными линиями обозначены средние):</p>
<p><img src="DS_for_DH_files/figure-html/unnamed-chunk-606-1.png" width="672" /></p>
<p>Если значения <span class="math inline">\(x_i\)</span> и <span class="math inline">\(y_i\)</span> какой-то точки либо оба больше, либо оба меньше средних <span class="math inline">\(\bar{x}\)</span> и <span class="math inline">\(\bar{y}\)</span>, то получившееся произведение будет иметь знак <code>+</code>, если же наоборот — знак <code>-</code>. На графике это показано цветом.</p>
<p><img src="DS_for_DH_files/figure-html/unnamed-chunk-607-1.png" width="672" /></p>
<p>Таким образом, если много красных прямоугольников, то значение суммы будет положительное и обозначать положительную связь (чем больше <span class="math inline">\(x\)</span>, тем больше <span class="math inline">\(y\)</span>), а если будет много синий прямоугольников, то значение суммы отрицательное и обозначать положительную связь (чем больше <span class="math inline">\(x\)</span>, тем меньше <span class="math inline">\(y\)</span>). Непосредственно значение ковариации не очень информативно, так как может достаточно сильно варьироваться от датасета к датасету.</p>
<p>В R ковариацию можно посчитать при помощи функции <code>cov()</code>.</p>
<div class="sourceCode" id="cb1137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1137-1"><a href="корреляция-и-регрессия.html#cb1137-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb1137-2"><a href="корреляция-и-регрессия.html#cb1137-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">10</span>, <span class="at">mean =</span> <span class="dv">50</span>, <span class="at">sd =</span> <span class="dv">10</span>)</span>
<span id="cb1137-3"><a href="корреляция-и-регрессия.html#cb1137-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span>  x <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">10</span>, <span class="at">sd =</span> <span class="dv">10</span>)</span>
<span id="cb1137-4"><a href="корреляция-и-регрессия.html#cb1137-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cov</span>(x, y)</span></code></pre></div>
<pre><code>[1] 18.72204</code></pre>
<div class="sourceCode" id="cb1139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1139-1"><a href="корреляция-и-регрессия.html#cb1139-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cov</span>(x, <span class="sc">-</span>y<span class="sc">*</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>[1] -37.44407</code></pre>
<p>Как видно, простое умножение на два удвоило значение ковариации, что показывает, что непосредственно ковариацию использовать для сравнения разных датасетов не стоит.</p>
<p>Проверим, что функция выдает то же, что мы записали в формуле.</p>
<div class="sourceCode" id="cb1141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1141-1"><a href="корреляция-и-регрессия.html#cb1141-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cov</span>(x, y) <span class="sc">==</span> <span class="fu">sum</span>((x<span class="sc">-</span><span class="fu">mean</span>(x))<span class="sc">*</span>(y <span class="sc">-</span> <span class="fu">mean</span>(y)))<span class="sc">/</span>(<span class="fu">length</span>(x)<span class="sc">-</span><span class="dv">1</span>)</span></code></pre></div>
<pre><code>[1] TRUE</code></pre>
</div>
<div id="корреляция" class="section level2" number="15.4">
<h2><span class="header-section-number">15.4</span> Корреляция</h2>
<p><strong>Корреляция</strong> — это мера ассоциации/связи двух числовых переменных. Помните, что бытовое применение этого термина к категориальным переменным (например, корреляция цвета глаз и успеваемость на занятиях по R) не имеет смысла с точки зрения статистики.</p>
<div id="корреляция-пирсона" class="section level3" number="15.4.1">
<h3><span class="header-section-number">15.4.1</span> Корреляция Пирсона</h3>
<p><strong>Коэффициент корреляции Пирсона</strong> — базовый коэффициент ассоциации переменных, однако стоит помнить, что он дает неправильную оценку, если связь между переменными нелинейна.</p>
<p><span class="math display">\[\rho_{X,Y} = \frac{cov(X, Y)}{\sigma_X\times\sigma_Y} = \frac{1}{n-1}\times\sum_{i = 1}^n\left(\frac{x_i-\bar{x}}{\sigma_X}\times\frac{y_i-\bar{y}}{\sigma_Y}\right),\]</span></p>
<p>где</p>
<ul>
<li><span class="math inline">\((x_1, y_1), ..., (x_n, y_n)\)</span> — пары наблюдений;</li>
<li><span class="math inline">\(\bar{x}, \bar{y}\)</span> — средние наблюдений;</li>
<li><span class="math inline">\(X, Y\)</span> — векторы всех наблюдений;</li>
<li><span class="math inline">\(n\)</span> — количество наблюдений.</li>
</ul>
<p>Последнее уравнение показывает, что коэффициент корреляции Пирсона можно представить как среднее (с поправкой, поэтому <span class="math inline">\(n-1\)</span>, а не <span class="math inline">\(n\)</span>) произведение <span class="math inline">\(z\)</span>-нормализованных значений двух переменных.</p>
<p><img src="DS_for_DH_files/figure-html/unnamed-chunk-610-1.png" width="672" /></p>
<p>Эта нормализация приводит к тому, что</p>
<ul>
<li>значения корреляции имеют те же свойства знака коэффициента что и ковариация:
<ul>
<li>если коэффициент положительный (т. е. много красных прямоугольников) — связь между переменными положительная (чем <strong>больше</strong> <span class="math inline">\(x\)</span>, тем <strong>больше</strong> <span class="math inline">\(y\)</span>),</li>
<li>если коэффициент отрицательный (т. е. много синих прямоугольников) — связь между переменными отрицательная (чем <strong>больше</strong> <span class="math inline">\(x\)</span>, тем <strong>меньше</strong> <span class="math inline">\(y\)</span>);</li>
</ul></li>
<li>значение корреляции имееет независимое от типа данных интеретация:
<ul>
<li>если модуль коэффициента близок к 1 или ему равен — связь между переменными сильная,</li>
<li>если модуль коэффициента близок к 0 или ему равен — связь между переменными слабая.</li>
</ul></li>
</ul>
<p>Для того чтобы было понятнее, что такое корреляция, давайте рассмотрим несколько расспределений с разными значениями корреляции:</p>
<p><img src="DS_for_DH_files/figure-html/unnamed-chunk-611-1.png" width="672" /></p>
<p>Как видно из этого графика, чем ближе модуль корреляции к 1, тем боллее компактно расположены точки друг к другу, чем ближе к 0, тем более рассеяны значения. Достаточно легко научиться приблизительно оценивать коэфициент корреляции на глаз, поиграв 2–5 минут в игру “Угадай корреляцию” <a href="http://guessthecorrelation.com/">здесь</a> или <a href="https://cheng-dsdp.shinyapps.io/CorApp/">здесь</a>.</p>
<p>В R коэффициент корреляции Пирсона можно посчитать при помощи функции <code>cor()</code>.</p>
<div class="sourceCode" id="cb1143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1143-1"><a href="корреляция-и-регрессия.html#cb1143-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb1143-2"><a href="корреляция-и-регрессия.html#cb1143-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">15</span>, <span class="at">mean =</span> <span class="dv">50</span>, <span class="at">sd =</span> <span class="dv">10</span>)</span>
<span id="cb1143-3"><a href="корреляция-и-регрессия.html#cb1143-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span>  x <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">15</span>, <span class="at">sd =</span> <span class="dv">10</span>)</span>
<span id="cb1143-4"><a href="корреляция-и-регрессия.html#cb1143-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(x, y)</span></code></pre></div>
<pre><code>[1] 0.6659041</code></pre>
<p>Проверим, что функция выдает то же, что мы записали в формуле.</p>
<div class="sourceCode" id="cb1145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1145-1"><a href="корреляция-и-регрессия.html#cb1145-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(x, y) <span class="sc">==</span> <span class="fu">cov</span>(x, y)<span class="sc">/</span>(<span class="fu">sd</span>(x)<span class="sc">*</span><span class="fu">sd</span>(y))</span></code></pre></div>
<pre><code>[1] TRUE</code></pre>
<div class="sourceCode" id="cb1147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1147-1"><a href="корреляция-и-регрессия.html#cb1147-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(x, y) <span class="sc">==</span> <span class="fu">sum</span>(<span class="fu">scale</span>(x)<span class="sc">*</span><span class="fu">scale</span>(y))<span class="sc">/</span>(<span class="fu">length</span>(x)<span class="sc">-</span><span class="dv">1</span>)</span></code></pre></div>
<pre><code>[1] TRUE</code></pre>
<div class="rmdtask">
<p>
Посчитайте на основе <a href="https://raw.githubusercontent.com/agricolamz/DS_for_DH/master/data/moscow_average_temperature.csv">датасета с температурой</a> корреляцию между разными измерениями в шкалах Фарингейта и Цельсия? Результаты округлите до трех знаков после запятой.
</p>
</div>
<form name="form_64410" onsubmit="return validate_form_64410()" method="post">
<input type="text" name="answer_64410"><br><input type="submit" value="check">
</form>
<p id="result_64410">
</p>
<script> function validate_form_64410() {var x, text; var x = document.forms["form_64410"]["answer_64410"].value;if (x == "0.997"){text = 'Correct';} else {text = 'I have a different answer';} document.getElementById('result_64410').innerHTML = text; return false;} </script>
</div>
<div id="ранговые-корреляции-спирмана-и-кендалла" class="section level3" number="15.4.2">
<h3><span class="header-section-number">15.4.2</span> Ранговые корреляции Спирмана и Кендалла</h3>
<p>Коэффициент корреляции Пирсона к сожалению, чувствителен к значениям наблюдений. Если связь между переменными нелинейна, то оценка будет получаться смещенной. Рассмотрим, например, словарь [Ляшевской, Шарова 2011]:</p>
<div class="sourceCode" id="cb1149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1149-1"><a href="корреляция-и-регрессия.html#cb1149-1" aria-hidden="true" tabindex="-1"></a>freqdict <span class="ot">&lt;-</span> <span class="fu">read_tsv</span>(<span class="st">&quot;https://github.com/agricolamz/DS_for_DH/raw/master/data/freq_dict_2011.csv&quot;</span>)</span>
<span id="cb1149-2"><a href="корреляция-и-регрессия.html#cb1149-2" aria-hidden="true" tabindex="-1"></a>freqdict <span class="sc">%&gt;%</span> </span>
<span id="cb1149-3"><a href="корреляция-и-регрессия.html#cb1149-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(freq_ipm)) <span class="sc">%&gt;%</span> </span>
<span id="cb1149-4"><a href="корреляция-и-регрессия.html#cb1149-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">id =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb1149-5"><a href="корреляция-и-регрессия.html#cb1149-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>) <span class="ot">-&gt;</span></span>
<span id="cb1149-6"><a href="корреляция-и-регрессия.html#cb1149-6" aria-hidden="true" tabindex="-1"></a>  filered_freqdict</span>
<span id="cb1149-7"><a href="корреляция-и-регрессия.html#cb1149-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1149-8"><a href="корреляция-и-регрессия.html#cb1149-8" aria-hidden="true" tabindex="-1"></a>filered_freqdict <span class="sc">%&gt;%</span> </span>
<span id="cb1149-9"><a href="корреляция-и-регрессия.html#cb1149-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(id, freq_ipm, <span class="at">label =</span> lemma))<span class="sc">+</span></span>
<span id="cb1149-10"><a href="корреляция-и-регрессия.html#cb1149-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb1149-11"><a href="корреляция-и-регрессия.html#cb1149-11" aria-hidden="true" tabindex="-1"></a>  ggrepel<span class="sc">::</span><span class="fu">geom_text_repel</span>()<span class="sc">+</span></span>
<span id="cb1149-12"><a href="корреляция-и-регрессия.html#cb1149-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>()</span></code></pre></div>
<p><img src="DS_for_DH_files/figure-html/unnamed-chunk-616-1.png" width="672" /></p>
<p>В целом корреляция между рангом и частотой должна быть высокая, однако связь между этими переменными нелинейна, так что коэффициент корреляции Пирсона не такой уж и высокий:</p>
<div class="sourceCode" id="cb1150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1150-1"><a href="корреляция-и-регрессия.html#cb1150-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(filered_freqdict<span class="sc">$</span>freq_ipm, filered_freqdict<span class="sc">$</span>id)</span></code></pre></div>
<pre><code>[1] -0.6307876</code></pre>
<p>Для решения той проблемы обычно используют ранговые коэффециенты коррляции Спирмана и Кендала, которые принимают во внимание ранг значения, а не его непосредственное значение.</p>
<div class="sourceCode" id="cb1152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1152-1"><a href="корреляция-и-регрессия.html#cb1152-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(filered_freqdict<span class="sc">$</span>freq_ipm, filered_freqdict<span class="sc">$</span>id, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span></code></pre></div>
<pre><code>[1] -1</code></pre>
<div class="sourceCode" id="cb1154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1154-1"><a href="корреляция-и-регрессия.html#cb1154-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(filered_freqdict<span class="sc">$</span>freq_ipm, filered_freqdict<span class="sc">$</span>id, <span class="at">method =</span> <span class="st">&quot;kendall&quot;</span>)</span></code></pre></div>
<pre><code>[1] -1</code></pre>
<p>Давайте сравним с предыдущими наблюдениями и их логаотфмамиы:</p>
<div class="sourceCode" id="cb1156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1156-1"><a href="корреляция-и-регрессия.html#cb1156-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(x, y) <span class="sc">==</span> <span class="fu">cor</span>(<span class="fu">log</span>(x), <span class="fu">log</span>(y))</span></code></pre></div>
<pre><code>[1] FALSE</code></pre>
<div class="sourceCode" id="cb1158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1158-1"><a href="корреляция-и-регрессия.html#cb1158-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(x, y, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>) <span class="sc">==</span> <span class="fu">cor</span>(<span class="fu">log</span>(x), <span class="fu">log</span>(y), <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span></code></pre></div>
<pre><code>[1] TRUE</code></pre>
<div class="sourceCode" id="cb1160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1160-1"><a href="корреляция-и-регрессия.html#cb1160-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(x, y, <span class="at">method =</span> <span class="st">&quot;kendall&quot;</span>) <span class="sc">==</span> <span class="fu">cor</span>(<span class="fu">log</span>(x), <span class="fu">log</span>(y), <span class="at">method =</span> <span class="st">&quot;kendall&quot;</span>)</span></code></pre></div>
<pre><code>[1] TRUE</code></pre>
</div>
</div>
<div id="регрессионный-анализ" class="section level2" number="15.5">
<h2><span class="header-section-number">15.5</span> Регрессионный анализ</h2>
<div id="основы" class="section level3" number="15.5.1">
<h3><span class="header-section-number">15.5.1</span> Основы</h3>
<p>Суть регрессионного анализа в моделировании связи между двумя и более переменными при помощи прямой на плоскости. Формула прямой зависит от двух параметров: свободного члена (intercept) и углового коэффициента (slope).</p>
<p><img src="DS_for_DH_files/figure-html/unnamed-chunk-620-1.png" width="672" /></p>
<div class="rmdtask">
<p>
Укажите значение свободного члена для красной прямой.
</p>
</div>
<form name="form_99172" onsubmit="return validate_form_99172()" method="post">
<input type="radio" name="answer_99172" id="99172_1" value="-2"><label for="1">-2</label> <input type="radio" name="answer_99172" id="99172_2" value="-1"><label for="2">-1</label> <input type="radio" name="answer_99172" id="99172_3" value="0"><label for="3">0</label> <input type="radio" name="answer_99172" id="99172_4" value="1"><label for="4">1</label> <input type="radio" name="answer_99172" id="99172_5" value="2"><label for="5">2</label> <input type="radio" name="answer_99172" id="99172_6" value="3"><label for="6">3</label> <input type="radio" name="answer_99172" id="99172_7" value="4"><label for="7">4</label> <br><input type="submit" value="check">
</form>
<p id="result_99172">
</p>
<script> function validate_form_99172() {var x, text; var x = document.forms["form_99172"]["answer_99172"].value;if (x == "1"){text = 'Correct';} else {text = 'I have a different answer';} document.getElementById('result_99172').innerHTML = text; return false;} </script>
<div class="rmdtask">
<p>
Укажите значение свободного члена для зеленой прямой.
</p>
</div>
<form name="form_92981" onsubmit="return validate_form_92981()" method="post">
<input type="radio" name="answer_92981" id="92981_1" value="-2"><label for="1">-2</label> <input type="radio" name="answer_92981" id="92981_2" value="-1"><label for="2">-1</label> <input type="radio" name="answer_92981" id="92981_3" value="0"><label for="3">0</label> <input type="radio" name="answer_92981" id="92981_4" value="1"><label for="4">1</label> <input type="radio" name="answer_92981" id="92981_5" value="2"><label for="5">2</label> <input type="radio" name="answer_92981" id="92981_6" value="3"><label for="6">3</label> <input type="radio" name="answer_92981" id="92981_7" value="4"><label for="7">4</label> <br><input type="submit" value="check">
</form>
<p id="result_92981">
</p>
<script> function validate_form_92981() {var x, text; var x = document.forms["form_92981"]["answer_92981"].value;if (x == "2"){text = 'Correct';} else {text = 'I have a different answer';} document.getElementById('result_92981').innerHTML = text; return false;} </script>
<div class="rmdtask">
<p>
Укажите значение свободного члена для синей прямой.
</p>
</div>
<form name="form_72614" onsubmit="return validate_form_72614()" method="post">
<input type="radio" name="answer_72614" id="72614_1" value="-2"><label for="1">-2</label> <input type="radio" name="answer_72614" id="72614_2" value="-1"><label for="2">-1</label> <input type="radio" name="answer_72614" id="72614_3" value="0"><label for="3">0</label> <input type="radio" name="answer_72614" id="72614_4" value="1"><label for="4">1</label> <input type="radio" name="answer_72614" id="72614_5" value="2"><label for="5">2</label> <input type="radio" name="answer_72614" id="72614_6" value="3"><label for="6">3</label> <input type="radio" name="answer_72614" id="72614_7" value="4"><label for="7">4</label> <br><input type="submit" value="check">
</form>
<p id="result_72614">
</p>
<script> function validate_form_72614() {var x, text; var x = document.forms["form_72614"]["answer_72614"].value;if (x == "3"){text = 'Correct';} else {text = 'I have a different answer';} document.getElementById('result_72614').innerHTML = text; return false;} </script>
<div class="rmdtask">
<p>
Укажите значение углового коэффициента для красной прямой.
</p>
</div>
<form name="form_82901" onsubmit="return validate_form_82901()" method="post">
<input type="radio" name="answer_82901" id="82901_1" value="-2"><label for="1">-2</label> <input type="radio" name="answer_82901" id="82901_2" value="-1"><label for="2">-1</label> <input type="radio" name="answer_82901" id="82901_3" value="0"><label for="3">0</label> <input type="radio" name="answer_82901" id="82901_4" value="1"><label for="4">1</label> <input type="radio" name="answer_82901" id="82901_5" value="2"><label for="5">2</label> <input type="radio" name="answer_82901" id="82901_6" value="3"><label for="6">3</label> <input type="radio" name="answer_82901" id="82901_7" value="4"><label for="7">4</label> <br><input type="submit" value="check">
</form>
<p id="result_82901">
</p>
<script> function validate_form_82901() {var x, text; var x = document.forms["form_82901"]["answer_82901"].value;if (x == "1"){text = 'Correct';} else {text = 'I have a different answer';} document.getElementById('result_82901').innerHTML = text; return false;} </script>
<div class="rmdtask">
<p>
Укажите значение углового коэффициента для зеленой прямой.
</p>
</div>
<form name="form_90827" onsubmit="return validate_form_90827()" method="post">
<input type="radio" name="answer_90827" id="90827_1" value="-2"><label for="1">-2</label> <input type="radio" name="answer_90827" id="90827_2" value="-1"><label for="2">-1</label> <input type="radio" name="answer_90827" id="90827_3" value="0"><label for="3">0</label> <input type="radio" name="answer_90827" id="90827_4" value="1"><label for="4">1</label> <input type="radio" name="answer_90827" id="90827_5" value="2"><label for="5">2</label> <input type="radio" name="answer_90827" id="90827_6" value="3"><label for="6">3</label> <input type="radio" name="answer_90827" id="90827_7" value="4"><label for="7">4</label> <br><input type="submit" value="check">
</form>
<p id="result_90827">
</p>
<script> function validate_form_90827() {var x, text; var x = document.forms["form_90827"]["answer_90827"].value;if (x == "2"){text = 'Correct';} else {text = 'I have a different answer';} document.getElementById('result_90827').innerHTML = text; return false;} </script>
<div class="rmdtask">
<p>
Укажите значение углового коэффициента для синей прямой.
</p>
</div>
<form name="form_47310" onsubmit="return validate_form_47310()" method="post">
<input type="radio" name="answer_47310" id="47310_1" value="-2"><label for="1">-2</label> <input type="radio" name="answer_47310" id="47310_2" value="-1"><label for="2">-1</label> <input type="radio" name="answer_47310" id="47310_3" value="0"><label for="3">0</label> <input type="radio" name="answer_47310" id="47310_4" value="1"><label for="4">1</label> <input type="radio" name="answer_47310" id="47310_5" value="2"><label for="5">2</label> <input type="radio" name="answer_47310" id="47310_6" value="3"><label for="6">3</label> <input type="radio" name="answer_47310" id="47310_7" value="4"><label for="7">4</label> <br><input type="submit" value="check">
</form>
<p id="result_47310">
</p>
<script> function validate_form_47310() {var x, text; var x = document.forms["form_47310"]["answer_47310"].value;if (x == "-1"){text = 'Correct';} else {text = 'I have a different answer';} document.getElementById('result_47310').innerHTML = text; return false;} </script>
<p>Когда мы пытаемся научиться предсказывать данные одной переменной <span class="math inline">\(Y\)</span> при помощи другой переменной <span class="math inline">\(X\)</span>, мы получаем похожую формулу:</p>
<p><span class="math display">\[y_i = \hat\beta_0 + \hat\beta_1 \times x_i + \epsilon_i,\]</span>
где</p>
<ul>
<li><span class="math inline">\(x_i\)</span> — <span class="math inline">\(i\)</span>-ый элемент вектора значений <span class="math inline">\(X\)</span>;</li>
<li><span class="math inline">\(y_i\)</span> — <span class="math inline">\(i\)</span>-ый элемент вектора значений <span class="math inline">\(Y\)</span>;</li>
<li><span class="math inline">\(\hat\beta_0\)</span> — оценка случайного члена (intercept);</li>
<li><span class="math inline">\(\hat\beta_1\)</span> — оценка углового коэффициента (slope);</li>
<li><span class="math inline">\(\epsilon_i\)</span> — <span class="math inline">\(i\)</span>-ый остаток, разница между оценкой модели (<span class="math inline">\(\hat\beta_0 + \hat\beta_1 \times x_i\)</span>) и реальным значением <span class="math inline">\(y_i\)</span>; весь вектор остатков иногда называют случайным шумом (на графике выделены красным).</li>
</ul>
<p><img src="DS_for_DH_files/figure-html/unnamed-chunk-633-1.png" width="672" /></p>
<p>Задача регрессии — оценить параметры <span class="math inline">\(\hat\beta_0\)</span> и <span class="math inline">\(\hat\beta_1\)</span>, если нам известны все значения <span class="math inline">\(x_i\)</span> и <span class="math inline">\(y_i\)</span> и мы пытаемся минимизировать значния <span class="math inline">\(\epsilon_i\)</span>. В данном конкретном случае, задачу можно решить аналитически и получить следующие формулы:</p>
<p><span class="math display">\[\hat\beta_1 = \frac{(\sum_{i=1}^n x_i\times y_i)-n\times\bar x \times \bar y}{\sum_{i = 1}^n(x_i-\bar x)^2}\]</span></p>
<p><span class="math display">\[\hat\beta_0 = \bar y - \hat\beta_1\times\bar x\]</span></p>
</div>
<div id="первая-регрессия" class="section level3" number="15.5.2">
<h3><span class="header-section-number">15.5.2</span> Первая регрессия</h3>
<p>Давайте попробуем смоделировать количество слов <em>и</em> в рассказах М. Зощенко в зависимости от длины рассказа:</p>
<div class="sourceCode" id="cb1162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1162-1"><a href="корреляция-и-регрессия.html#cb1162-1" aria-hidden="true" tabindex="-1"></a>zo <span class="ot">&lt;-</span> <span class="fu">read_tsv</span>(<span class="st">&quot;https://github.com/agricolamz/DS_for_DH/raw/master/data/tidy_zoshenko.csv&quot;</span>)</span>
<span id="cb1162-2"><a href="корреляция-и-регрессия.html#cb1162-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1162-3"><a href="корреляция-и-регрессия.html#cb1162-3" aria-hidden="true" tabindex="-1"></a>zo <span class="sc">%&gt;%</span> </span>
<span id="cb1162-4"><a href="корреляция-и-регрессия.html#cb1162-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(word <span class="sc">==</span> <span class="st">&quot;и&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1162-5"><a href="корреляция-и-регрессия.html#cb1162-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1162-6"><a href="корреляция-и-регрессия.html#cb1162-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(n_words, n))<span class="sc">+</span></span>
<span id="cb1162-7"><a href="корреляция-и-регрессия.html#cb1162-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb1162-8"><a href="корреляция-и-регрессия.html#cb1162-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;количество слов в рассказе&quot;</span>,</span>
<span id="cb1162-9"><a href="корреляция-и-регрессия.html#cb1162-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;количество и&quot;</span>)</span></code></pre></div>
<p><img src="DS_for_DH_files/figure-html/unnamed-chunk-634-1.png" width="672" /></p>
<p>Мы видим, несколько одиночных точек, давайте избавимся от них и добавим регрессионную линию при помощи функции <code>geom_smooth()</code>:</p>
<div class="sourceCode" id="cb1163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1163-1"><a href="корреляция-и-регрессия.html#cb1163-1" aria-hidden="true" tabindex="-1"></a>zo <span class="sc">%&gt;%</span> </span>
<span id="cb1163-2"><a href="корреляция-и-регрессия.html#cb1163-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(word <span class="sc">==</span> <span class="st">&quot;и&quot;</span>,</span>
<span id="cb1163-3"><a href="корреляция-и-регрессия.html#cb1163-3" aria-hidden="true" tabindex="-1"></a>         n_words <span class="sc">&lt;</span> <span class="dv">1500</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1163-4"><a href="корреляция-и-регрессия.html#cb1163-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="ot">-&gt;</span></span>
<span id="cb1163-5"><a href="корреляция-и-регрессия.html#cb1163-5" aria-hidden="true" tabindex="-1"></a>  zo_filtered</span>
<span id="cb1163-6"><a href="корреляция-и-регрессия.html#cb1163-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1163-7"><a href="корреляция-и-регрессия.html#cb1163-7" aria-hidden="true" tabindex="-1"></a>zo_filtered <span class="sc">%&gt;%</span>   </span>
<span id="cb1163-8"><a href="корреляция-и-регрессия.html#cb1163-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(n_words, n))<span class="sc">+</span></span>
<span id="cb1163-9"><a href="корреляция-и-регрессия.html#cb1163-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb1163-10"><a href="корреляция-и-регрессия.html#cb1163-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> <span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb1163-11"><a href="корреляция-и-регрессия.html#cb1163-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;количество слов в рассказе&quot;</span>,</span>
<span id="cb1163-12"><a href="корреляция-и-регрессия.html#cb1163-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;количество и&quot;</span>)</span></code></pre></div>
<p><img src="DS_for_DH_files/figure-html/unnamed-chunk-635-1.png" width="672" /></p>
<p>Чтобы получить формулу этой линии нужно запустить функцию, которая оценивает линейную регрессию:</p>
<div class="sourceCode" id="cb1164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1164-1"><a href="корреляция-и-регрессия.html#cb1164-1" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(n<span class="sc">~</span>n_words, <span class="at">data =</span> zo_filtered)</span>
<span id="cb1164-2"><a href="корреляция-и-регрессия.html#cb1164-2" aria-hidden="true" tabindex="-1"></a>fit</span></code></pre></div>
<pre><code>
Call:
lm(formula = n ~ n_words, data = zo_filtered)

Coefficients:
(Intercept)      n_words  
   -1.47184      0.04405  </code></pre>
<p>Вот мы и получили коэффициенты, теперь мы видим, что наша модель считает следующее:</p>
<p><span class="math display">\[n = -1.47184 + 0.04405 \times n\_words\]</span></p>
<p>Более подробную информцию можно посмотреть, если запустить модель в функцию <code>summary()</code>:</p>
<div class="sourceCode" id="cb1166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1166-1"><a href="корреляция-и-регрессия.html#cb1166-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit)</span></code></pre></div>
<pre><code>
Call:
lm(formula = n ~ n_words, data = zo_filtered)

Residuals:
     Min       1Q   Median       3Q      Max 
-19.6830  -4.3835   0.8986   4.6486  19.6413 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -1.471840   2.467149  -0.597    0.553    
n_words      0.044049   0.003666  12.015   &lt;2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 7.945 on 64 degrees of freedom
Multiple R-squared:  0.6928,    Adjusted R-squared:  0.688 
F-statistic: 144.4 on 1 and 64 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>В разделе <code>Coefficients</code> содержится информацию про наши коэффициенты:</p>
<ul>
<li><code>Estimate</code> – полученная оценка коэффициентов;</li>
<li><code>Std. Error</code> – стандартная ошибка среднего;</li>
<li><code>t value</code> – <span class="math inline">\(t\)</span>-статистика, полученная при проведении одновыборочного <span class="math inline">\(t\)</span>-теста, сравнивающего данный коэфициент с 0;</li>
<li><code>Pr(&gt;|t|)</code> – полученное <span class="math inline">\(p\)</span>-значение;</li>
<li><code>Multiple R-squared</code> и <code>Adjusted R-squared</code> — одна из оценок модели, показывает связь между переменными. Без поправок совпадает с квадратом коэффициента корреляции Пирсона:</li>
</ul>
<div class="sourceCode" id="cb1168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1168-1"><a href="корреляция-и-регрессия.html#cb1168-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(zo_filtered<span class="sc">$</span>n_words, zo_filtered<span class="sc">$</span>n)<span class="sc">^</span><span class="dv">2</span></span></code></pre></div>
<pre><code>[1] 0.6928376</code></pre>
<ul>
<li><code>F-statistic</code> — <span class="math inline">\(F\)</span>-статистика полученная при проведении теста, проверяющего, не являются ли хотя бы один из коэффицинтов статистически значимо отличается от нуля. Совпадает с результатами дисперсионного анализа (ANOVA).</li>
</ul>
<p>Теперь мы можем даже предсказывать значения, которые мы еще не видели. Например, сколько будет и в рассказе Зощенко длиной 1000 слов?</p>
<p><img src="DS_for_DH_files/figure-html/unnamed-chunk-639-1.png" width="672" /></p>
<div class="sourceCode" id="cb1170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1170-1"><a href="корреляция-и-регрессия.html#cb1170-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(fit, <span class="fu">tibble</span>(<span class="at">n_words =</span> <span class="dv">1000</span>))</span></code></pre></div>
<pre><code>       1 
42.57715 </code></pre>
<div class="rmdtask">
<p>
Постройте ленейную ргерессию на основании <a href="https://github.com/agricolamz/DS_for_DH/raw/master/data/tidy_chekhov.tsv">рассказов А. Чехова</a>, предсказывая количество и на основании количства слов. При моделировании используйте только рассказы длиной меньше 2500 слов. Укажите свободный член получившейся модели, округлив его до 3 знаков после запятой.
</p>
</div>
<form name="form_72989" onsubmit="return validate_form_72989()" method="post">
<input type="text" name="answer_72989"><br><input type="submit" value="check">
</form>
<p id="result_72989">
</p>
<script> function validate_form_72989() {var x, text; var x = document.forms["form_72989"]["answer_72989"].value;if (x == "-0.814"){text = 'Correct';} else {text = 'I have a different answer';} document.getElementById('result_72989').innerHTML = text; return false;} </script>
<div class="rmdtask">
<p>
Укажите угловой коффициент получившейся модели, округлив его до 3 знаков после запятой.
</p>
</div>
<form name="form_40870" onsubmit="return validate_form_40870()" method="post">
<input type="text" name="answer_40870"><br><input type="submit" value="check">
</form>
<p id="result_40870">
</p>
<script> function validate_form_40870() {var x, text; var x = document.forms["form_40870"]["answer_40870"].value;if (x == "0.044"){text = 'Correct';} else {text = 'I have a different answer';} document.getElementById('result_40870').innerHTML = text; return false;} </script>
<div class="rmdtask">
<p>
Укажите предсказания модели для рассказа длиной 1000 слов, округлив получнное значение до 3 знаков после запятой.
</p>
</div>
<form name="form_5261" onsubmit="return validate_form_5261()" method="post">
<input type="text" name="answer_5261"><br><input type="submit" value="check">
</form>
<p id="result_5261">
</p>
<script> function validate_form_5261() {var x, text; var x = document.forms["form_5261"]["answer_5261"].value;if (x == "42.771"){text = 'Correct';} else {text = 'I have a different answer';} document.getElementById('result_5261').innerHTML = text; return false;} </script>
</div>
<div id="категориальные-переменные-1" class="section level3" number="15.5.3">
<h3><span class="header-section-number">15.5.3</span> Категориальные переменные</h3>
<p>Что если мы хотим включить в наш анализ категориальные переменные? Давайте рассмотрим простой пример с <a href="https://github.com/agricolamz/DS_for_DH/raw/master/data/tidy_chekhov.tsv">рассказами Чехова</a> и <a href="https://github.com/agricolamz/DS_for_DH/raw/master/data/tidy_zoshenko.csv">Зощенко</a>, которые мы рассматривали в прошлом разделе. Мы будем анализировать логарифм доли слов деньги:</p>
<div class="sourceCode" id="cb1172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1172-1"><a href="корреляция-и-регрессия.html#cb1172-1" aria-hidden="true" tabindex="-1"></a>chekhov <span class="ot">&lt;-</span> <span class="fu">read_tsv</span>(<span class="st">&quot;https://github.com/agricolamz/DS_for_DH/raw/master/data/tidy_chekhov.tsv&quot;</span>)</span>
<span id="cb1172-2"><a href="корреляция-и-регрессия.html#cb1172-2" aria-hidden="true" tabindex="-1"></a>zoshenko <span class="ot">&lt;-</span> <span class="fu">read_tsv</span>(<span class="st">&quot;https://github.com/agricolamz/DS_for_DH/raw/master/data/tidy_zoshenko.csv&quot;</span>)</span>
<span id="cb1172-3"><a href="корреляция-и-регрессия.html#cb1172-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1172-4"><a href="корреляция-и-регрессия.html#cb1172-4" aria-hidden="true" tabindex="-1"></a>chekhov<span class="sc">$</span>author <span class="ot">&lt;-</span> <span class="st">&quot;Чехов&quot;</span></span>
<span id="cb1172-5"><a href="корреляция-и-регрессия.html#cb1172-5" aria-hidden="true" tabindex="-1"></a>zoshenko<span class="sc">$</span>author <span class="ot">&lt;-</span> <span class="st">&quot;Зощенко&quot;</span></span>
<span id="cb1172-6"><a href="корреляция-и-регрессия.html#cb1172-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1172-7"><a href="корреляция-и-регрессия.html#cb1172-7" aria-hidden="true" tabindex="-1"></a>chekhov <span class="sc">%&gt;%</span> </span>
<span id="cb1172-8"><a href="корреляция-и-регрессия.html#cb1172-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(zoshenko) <span class="sc">%&gt;%</span> </span>
<span id="cb1172-9"><a href="корреляция-и-регрессия.html#cb1172-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(word, <span class="st">&quot;деньг&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1172-10"><a href="корреляция-и-регрессия.html#cb1172-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(author, titles, n_words) <span class="sc">%&gt;%</span> </span>
<span id="cb1172-11"><a href="корреляция-и-регрессия.html#cb1172-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">sum</span>(n)) <span class="sc">%&gt;%</span> </span>
<span id="cb1172-12"><a href="корреляция-и-регрессия.html#cb1172-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">log_ratio =</span> <span class="fu">log</span>(n<span class="sc">/</span>n_words)) <span class="ot">-&gt;</span></span>
<span id="cb1172-13"><a href="корреляция-и-регрессия.html#cb1172-13" aria-hidden="true" tabindex="-1"></a>  checkov_zoshenko</span></code></pre></div>
<p>Визуализация выглядит так:
<img src="DS_for_DH_files/figure-html/unnamed-chunk-648-1.png" width="672" /></p>
<p>Красной точкой обозначены средние значения, так что мы видим, что между двумя писателями есть разница, но является ли она статистически значимой? В прошлом разделе, мы рассмотрели, что в таком случае можно сделать t-test:</p>
<div class="sourceCode" id="cb1173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1173-1"><a href="корреляция-и-регрессия.html#cb1173-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(log_ratio<span class="sc">~</span>author, </span>
<span id="cb1173-2"><a href="корреляция-и-регрессия.html#cb1173-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">data =</span> checkov_zoshenko, </span>
<span id="cb1173-3"><a href="корреляция-и-регрессия.html#cb1173-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">var.equal =</span><span class="cn">TRUE</span>) <span class="co"># здесь я мухлюю, отключая поправку Уэлча</span></span></code></pre></div>
<pre><code>
    Two Sample t-test

data:  log_ratio by author
t = 5.6871, df = 125, p-value = 8.665e-08
alternative hypothesis: true difference in means between group Зощенко and group Чехов is not equal to 0
95 percent confidence interval:
 0.8606107 1.7793181
sample estimates:
mean in group Зощенко   mean in group Чехов 
            -5.021262             -6.341226 </code></pre>
<p>Разница между группами является статистически значимой (t(125) = 5.6871, p-value = 8.665e-08).</p>
<p>Для того, чтобы запустить регрессию на категориальных данных категориальная переменная автоматически разбивается на группу бинарных dummy-переменных:</p>
<div class="sourceCode" id="cb1175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1175-1"><a href="корреляция-и-регрессия.html#cb1175-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">author =</span> <span class="fu">c</span>(<span class="st">&quot;Чехов&quot;</span>, <span class="st">&quot;Зощенко&quot;</span>),</span>
<span id="cb1175-2"><a href="корреляция-и-регрессия.html#cb1175-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">dummy_chekhov =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb1175-3"><a href="корреляция-и-регрессия.html#cb1175-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">dummy_zoshenko =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["author"],"name":[1],"type":["chr"],"align":["left"]},{"label":["dummy_chekhov"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["dummy_zoshenko"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"Чехов","2":"1","3":"0"},{"1":"Зощенко","2":"0","3":"1"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>Дальше для регрессионного анализа выкидывают одну из переменных, так как иначе модель не сойдется (dummy-переменных всегда n-1, где n — количество категорий в переменной).</p>
<div class="sourceCode" id="cb1176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1176-1"><a href="корреляция-и-регрессия.html#cb1176-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">author =</span> <span class="fu">c</span>(<span class="st">&quot;Чехов&quot;</span>, <span class="st">&quot;Зощенко&quot;</span>),</span>
<span id="cb1176-2"><a href="корреляция-и-регрессия.html#cb1176-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">dummy_chekhov =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>))</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["author"],"name":[1],"type":["chr"],"align":["left"]},{"label":["dummy_chekhov"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"Чехов","2":"1"},{"1":"Зощенко","2":"0"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>Если переменная <code>dummy_chekhov</code> принимает значение 1, значит речь о рассказе Чехова, а если принимает значение 0, то о рассказе Зощенко. Если вставить нашу переменную в регрессионную формулу получится следующее:</p>
<p><span class="math display">\[y_i = \hat\beta_0 + \hat\beta_1 \times \text{dummy_chekhov} + \epsilon_i,\]</span></p>
<p>Так как <code>dummy_chekhov</code> принимает либо значение 1, либо значение 0, то получается, что модель предсказывает лишь два значения:</p>
<p><span class="math display">\[y_i = \left\{\begin{array}{ll}\hat\beta_0 + \hat\beta_1 \times 1 + \epsilon_i = \hat\beta_0 + \hat\beta_1 + \epsilon_i\text{, если рассказ Чехова}\\ 
\hat\beta_0 + \hat\beta_1 \times 0 + \epsilon_i = \hat\beta_0 + \epsilon_i\text{, если рассказ Зощенко}
\end{array}\right.\]</span></p>
<p>Таким образом, получается, что свободный член <span class="math inline">\(\beta_0\)</span> и угловой коэффициент <span class="math inline">\(\beta_1\)</span> в регресси с категориальной переменной получает другую интерпретацию. Одно из значений переменной кодируется при помощи <span class="math inline">\(\beta_0\)</span>, а сумма коэффициентов <span class="math inline">\(\beta_0+\beta_1\)</span> дают другое значение переменной. Так что <span class="math inline">\(\beta_1\)</span> — это разница между оценками двух значений переменной.</p>
<p>Давайте теперь запустим регрессию на этих же данных:</p>
<div class="sourceCode" id="cb1177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1177-1"><a href="корреляция-и-регрессия.html#cb1177-1" aria-hidden="true" tabindex="-1"></a>fit2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(log_ratio<span class="sc">~</span>author, <span class="at">data =</span> checkov_zoshenko)</span>
<span id="cb1177-2"><a href="корреляция-и-регрессия.html#cb1177-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit2)</span></code></pre></div>
<pre><code>
Call:
lm(formula = log_ratio ~ author, data = checkov_zoshenko)

Residuals:
    Min      1Q  Median      3Q     Max 
-2.8652 -0.6105 -0.0607  0.6546  3.2398 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  -5.0213     0.2120 -23.680  &lt; 2e-16 ***
authorЧехов  -1.3200     0.2321  -5.687 8.67e-08 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 0.9717 on 125 degrees of freedom
Multiple R-squared:  0.2056,    Adjusted R-squared:  0.1992 
F-statistic: 32.34 on 1 and 125 DF,  p-value: 8.665e-08</code></pre>
<p>Во-первых стоит обратить внимание на то, что R сам преобразовал нашу категориальную переменную в dummy-переменную <code>authorЧехов</code>. Во-вторых, можно заметить, что значения t-статистики и p-value совпадают с результатами полученными нами в t-тесте выше. Статистическти значимый коэффициент при аргументе <code>authorЧехов</code> следует интерпретировать как разницу средних между логарифмом долей в рассказах Чехова и Зощенко.</p>
<div class="rmdtask">
<p>
В работе (Coretta 2017, <a href="https://goo.gl/NrfgJm" class="uri">https://goo.gl/NrfgJm</a>) рассматривается отношения между длительностью гласного и придыхание согласного. Автор собрал данные 5 носителей исландского. Дальше он извлек длительность гласного, после которого были придыхательные и непридыхательные. Скачайте <a href="https://raw.githubusercontent.com/agricolamz/DS_for_DH/master/data/icelandic.csv">данные</a> и постройте регрессионную модель, предсказывающую длительность гласного на основе .
</p>
</div>
</div>
<div id="множественная-регрессия" class="section level3" number="15.5.4">
<h3><span class="header-section-number">15.5.4</span> Множественная регрессия</h3>
<p>Множественная регрессия позволяет проанализировать связь между зависимой и несколькими зависимыми переменными. Формула множественной регрессии не сильно отличается от формулы обычной линейной регрессии:</p>
<p><span class="math display">\[y_i = \hat\beta_0 + \hat\beta_1 \times x_{1i}+ \dots+ \hat\beta_n \times x_{ni} + \epsilon_i,\]</span></p>
<ul>
<li><span class="math inline">\(x_{ki}\)</span> — <span class="math inline">\(i\)</span>-ый элемент векторов значений <span class="math inline">\(X_1, \dots, X_n\)</span>;</li>
<li><span class="math inline">\(y_i\)</span> — <span class="math inline">\(i\)</span>-ый элемент вектора значений <span class="math inline">\(Y\)</span>;</li>
<li><span class="math inline">\(\hat\beta_0\)</span> — оценка случайного члена (intercept);</li>
<li><span class="math inline">\(\hat\beta_k\)</span> — коэфциент при переменной <span class="math inline">\(X_{k}\)</span>;</li>
<li><span class="math inline">\(\epsilon_i\)</span> — <span class="math inline">\(i\)</span>-ый остаток, разница между оценкой модели (<span class="math inline">\(\hat\beta_0 + \hat\beta_1 \times x_i\)</span>) и реальным значением <span class="math inline">\(y_i\)</span>; весь вектор остатков иногда называют случайным шумом.</li>
</ul>
<p>В такой регресии предикторы могут быть как числовыми, так и категориальными (со всеми вытекающими последствиями, которые мы обсудили в предудщем разделе). Такую регрессию чаще всего сложно визуализировать, так как в одну регрессионную линию вкладываются сразу несколько переменных.</p>
<p>Попробуем предсказать длину лепестка на основе длины чашелистик и вида ириса:</p>
<div class="sourceCode" id="cb1179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1179-1"><a href="корреляция-и-регрессия.html#cb1179-1" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">%&gt;%</span> </span>
<span id="cb1179-2"><a href="корреляция-и-регрессия.html#cb1179-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(Sepal.Length, Petal.Length, <span class="at">color =</span> Species))<span class="sc">+</span></span>
<span id="cb1179-3"><a href="корреляция-и-регрессия.html#cb1179-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="DS_for_DH_files/figure-html/unnamed-chunk-654-1.png" width="672" /></p>
<p>Запустим регрессию:</p>
<div class="sourceCode" id="cb1180"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1180-1"><a href="корреляция-и-регрессия.html#cb1180-1" aria-hidden="true" tabindex="-1"></a>fit3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Petal.Length <span class="sc">~</span> Sepal.Length<span class="sc">+</span> Species, <span class="at">data =</span> iris)</span>
<span id="cb1180-2"><a href="корреляция-и-регрессия.html#cb1180-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit3)</span></code></pre></div>
<pre><code>
Call:
lm(formula = Petal.Length ~ Sepal.Length + Species, data = iris)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.76390 -0.17875  0.00716  0.17461  0.79954 

Coefficients:
                  Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)       -1.70234    0.23013  -7.397 1.01e-11 ***
Sepal.Length       0.63211    0.04527  13.962  &lt; 2e-16 ***
Speciesversicolor  2.21014    0.07047  31.362  &lt; 2e-16 ***
Speciesvirginica   3.09000    0.09123  33.870  &lt; 2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 0.2826 on 146 degrees of freedom
Multiple R-squared:  0.9749,    Adjusted R-squared:  0.9744 
F-statistic:  1890 on 3 and 146 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>Все предикторы статистически значимы. Давайте посмотрим предсказания модели для всех наблюдений:</p>
<div class="sourceCode" id="cb1182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1182-1"><a href="корреляция-и-регрессия.html#cb1182-1" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">%&gt;%</span> </span>
<span id="cb1182-2"><a href="корреляция-и-регрессия.html#cb1182-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prediction =</span> <span class="fu">predict</span>(fit3)) <span class="sc">%&gt;%</span> </span>
<span id="cb1182-3"><a href="корреляция-и-регрессия.html#cb1182-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(Sepal.Length, prediction, <span class="at">color =</span> Species))<span class="sc">+</span></span>
<span id="cb1182-4"><a href="корреляция-и-регрессия.html#cb1182-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="DS_for_DH_files/figure-html/unnamed-chunk-656-1.png" width="672" /></p>
<p>Всегда имеет смысл визуализировать, что нам говорит наша модель. Если использовать пакет <code>ggeffects</code> (или предшествовавший ему пакет <code>effects</code>), это можно сделать не сильно задумываясь, как это делать:</p>
<div class="sourceCode" id="cb1183"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1183-1"><a href="корреляция-и-регрессия.html#cb1183-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggeffects)</span>
<span id="cb1183-2"><a href="корреляция-и-регрессия.html#cb1183-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">ggpredict</span>(fit3, <span class="at">terms =</span> <span class="fu">c</span>(<span class="st">&quot;Sepal.Length&quot;</span>, <span class="st">&quot;Species&quot;</span>)))</span></code></pre></div>
<p><img src="DS_for_DH_files/figure-html/unnamed-chunk-657-1.png" width="672" /></p>
<p>Как видно из графиков, наша модель имеет одинаковые угловые коэффициенты (slope) для каждого из видов ириса и разные свободные члены (intercept).</p>
<div class="sourceCode" id="cb1184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1184-1"><a href="корреляция-и-регрессия.html#cb1184-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit3)</span></code></pre></div>
<pre><code>
Call:
lm(formula = Petal.Length ~ Sepal.Length + Species, data = iris)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.76390 -0.17875  0.00716  0.17461  0.79954 

Coefficients:
                  Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)       -1.70234    0.23013  -7.397 1.01e-11 ***
Sepal.Length       0.63211    0.04527  13.962  &lt; 2e-16 ***
Speciesversicolor  2.21014    0.07047  31.362  &lt; 2e-16 ***
Speciesvirginica   3.09000    0.09123  33.870  &lt; 2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 0.2826 on 146 degrees of freedom
Multiple R-squared:  0.9749,    Adjusted R-squared:  0.9744 
F-statistic:  1890 on 3 and 146 DF,  p-value: &lt; 2.2e-16</code></pre>
<p><span class="math display">\[y_i = \left\{\begin{array}{ll} -1.70234 + 0.63211 \times \text{Sepal.Length} + \epsilon_i\text{, если вид setosa}\\ 
-1.70234 + 2.2101 + 0.63211 \times \text{Sepal.Length} + \epsilon_i\text{, если вид versicolor} \\
-1.70234 + 3.09 + 0.63211 \times \text{Sepal.Length} + \epsilon_i\text{, если вид virginica}
\end{array}\right.\]</span></p>
</div>
<div id="сравнение-моделей" class="section level3" number="15.5.5">
<h3><span class="header-section-number">15.5.5</span> Сравнение моделей</h3>
<p>Как нам решить, какая модель лучше? Ведь теперь можно добавить сколько угодно предикторов? Давайте создадим новую модель без предиктора <code>Species</code>:</p>
<div class="sourceCode" id="cb1186"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1186-1"><a href="корреляция-и-регрессия.html#cb1186-1" aria-hidden="true" tabindex="-1"></a>fit4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Petal.Length <span class="sc">~</span> Sepal.Length, <span class="at">data =</span> iris)</span></code></pre></div>
<ul>
<li>можно сравнивать статистическую значимость предикторов</li>
<li>можно сравнивать <span class="math inline">\(R^2\)</span></li>
</ul>
<div class="sourceCode" id="cb1187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1187-1"><a href="корреляция-и-регрессия.html#cb1187-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit3)<span class="sc">$</span>adj.r.squared</span></code></pre></div>
<pre><code>[1] 0.9743786</code></pre>
<div class="sourceCode" id="cb1189"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1189-1"><a href="корреляция-и-регрессия.html#cb1189-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit4)<span class="sc">$</span>adj.r.squared</span></code></pre></div>
<pre><code>[1] 0.7583327</code></pre>
<ul>
<li>чаще всего используют так называемые информационные критерии, самый популярный – AIC (Akaike information criterion). Сами по себе значение этого критерия не имеет значения – только в сравнении моделей, построенных на похожих данных. Чем меньше значение, тем модель лучше.</li>
</ul>
<div class="sourceCode" id="cb1191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1191-1"><a href="корреляция-и-регрессия.html#cb1191-1" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(fit3, fit4)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["df"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["AIC"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"5","2":"52.47418","_rn_":"fit3"},{"1":"3","2":"387.13500","_rn_":"fit4"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="послесловие-1" class="section level3" number="15.5.6">
<h3><span class="header-section-number">15.5.6</span> Послесловие</h3>
<ul>
<li>сущетсвуют ограничения на применение линейной регресии
<ul>
<li>связь между предсказываемой переменной и предикторами должна быть линейной</li>
<li>остатки должны быть нормально распределены (оценивайте визуально)</li>
<li>дисперсия остатков вокруг регрессионной линии должно быть постоянно (гомоскидастично)</li>
<li>предикторы не должны коррелировать друг с другом</li>
<li>все наблюдения в регрессии должны быть независимы друг от друга</li>
</ul></li>
</ul>
<p>Вот так вот выглядят остатки нашей модели на основе датасета <code>iris</code>. Смотрите <a href="https://www.qualtrics.com/support/stats-iq/analyses/regression-guides/interpreting-residual-plots-improve-regression/">пост</a>, в котором обсуждается, как интерпретировать график остатков.</p>
<div class="sourceCode" id="cb1192"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1192-1"><a href="корреляция-и-регрессия.html#cb1192-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fit3, <span class="at">which=</span><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span></code></pre></div>
<p><img src="DS_for_DH_files/figure-html/unnamed-chunk-662-1.png" width="672" /><img src="DS_for_DH_files/figure-html/unnamed-chunk-662-2.png" width="672" /></p>
<ul>
<li>сущетсвуют трюки, позволяющие автоматически отбирать модели (см. функцию <code>step()</code>)</li>
<li>существует достаточно большое семейство регрессий, который зависят от типа независимой (предсказываемой) переменной или ее распределения
<ul>
<li>логистическая (если предсказываемая переменная имеет два возможных исхода)</li>
<li>мультиномиальная (если предсказываемая переменная имеет больше двух возможных дискретных исхода)</li>
<li>нелиненые регресии (если связь между переменными нелинейна)</li>
<li>регрессия со смешанными эффектами (если внутри данных есть группировки, т. е. наблюдения не независимы)</li>
<li>и другие.</li>
</ul></li>
</ul>

</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="24">
<li id="fn24"><p>Как и в других функциях, вычисляющих описательную статистику (<code>mean()</code>, <code>median()</code>, <code>max()</code>, <code>min()</code> и др.), функция <code>var()</code> (и все остальные функции, которые мы будем обсуждать <code>sd()</code>, <code>cov()</code>) возвращают <code>NA</code>, если в векторе есть пропущенные значения. Чтобы изменить это поведение, нужно добавить аргумент <code>na.rm = TRUE</code>.<a href="корреляция-и-регрессия.html#fnref24" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="проверка-статистических-гипотез.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="работа-статистического-детектива.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/agricolamz/DS_for_DH/edit/master/14-regression.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["DS_for_DH.pdf", "DS_for_DH.epub"],
"toc": {
"collapse": "section"
},
"self_contained": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
